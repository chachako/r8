// Copyright (c) 2026, the R8 project authors. Please see the AUTHORS file
// for details. All rights reserved. Use of this source code is governed by a
// BSD-style license that can be found in the LICENSE file.

// ***********************************************************************************
// GENERATED FILE. DO NOT EDIT! See GenerateBlastRadiusHtmlReportTemplate.java.
// ***********************************************************************************

package com.android.tools.r8.blastradius;

import java.nio.charset.StandardCharsets;
import java.util.Base64;

public class BlastRadiusHtmlReportTemplate {
  public static String getHtmlTemplate() {
    return decodeBase64(
        "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+UjggQmxhc3QgUmFkaXVzIFZpc3VhbGl6ZXI8L3RpdGxlPgogICAgPHN0eWxlPmJvZHkgewogICAgZm9udC1mYW1pbHk6ICdSb2JvdG8nLCBzYW5zLXNlcmlmOwogICAgbWFyZ2luOiAwOwogICAgcGFkZGluZzogMDsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgaGVpZ2h0OiAxMDB2aDsKICAgIGJhY2tncm91bmQtY29sb3I6ICNmNWY1ZjU7Cn0KCmhlYWRlciB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjM2Y1MWI1OwogICAgY29sb3I6IHdoaXRlOwogICAgcGFkZGluZzogMCAycmVtOwogICAgYm94LXNoYWRvdzogMCAycHggNHB4IHJnYmEoMCwwLDAsMC4xKTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgaGVpZ2h0OiA2NHB4Owp9CgojdGFicyB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgaGVpZ2h0OiAxMDAlOwp9CgoudGFiLWJ1dHRvbiB7CiAgICBiYWNrZ3JvdW5kOiBub25lOwogICAgYm9yZGVyOiBub25lOwogICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC43KTsKICAgIHBhZGRpbmc6IDAgMS41cmVtOwogICAgY3Vyc29yOiBwb2ludGVyOwogICAgZm9udC1zaXplOiAxcmVtOwogICAgZm9udC13ZWlnaHQ6IDUwMDsKICAgIHRyYW5zaXRpb246IGFsbCAwLjJzOwogICAgaGVpZ2h0OiAxMDAlOwogICAgYm9yZGVyLWJvdHRvbTogNHB4IHNvbGlkIHRyYW5zcGFyZW50Owp9CgoudGFiLWJ1dHRvbjpob3ZlciB7CiAgICBjb2xvcjogd2hpdGU7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7Cn0KCi50YWItYnV0dG9uLmFjdGl2ZSB7CiAgICBjb2xvcjogd2hpdGU7CiAgICBib3JkZXItYm90dG9tOiA0cHggc29saWQgd2hpdGU7Cn0KCiNjb250YWluZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGZsZXg6IDE7CiAgICBvdmVyZmxvdzogaGlkZGVuOwp9Cgojc2lkZWJhciB7CiAgICB3aWR0aDogMzUwcHg7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTsKICAgIGJvcmRlci1yaWdodDogMXB4IHNvbGlkICNkZGQ7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKfQoKI21haW4tY29udGVudCB7CiAgICBmbGV4OiAxOwogICAgcGFkZGluZzogMnJlbTsKICAgIG92ZXJmbG93LXk6IGF1dG87Cn0KCiNkcm9wLXpvbmUgewogICAgYm9yZGVyOiAycHggZGFzaGVkICMzZjUxYjU7CiAgICBib3JkZXItcmFkaXVzOiA4cHg7CiAgICBwYWRkaW5nOiAycmVtOwogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgY29sb3I6ICMzZjUxYjU7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICBtYXJnaW46IDFyZW07CiAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuM3M7Cn0KCiNkcm9wLXpvbmUuaG92ZXIgewogICAgYmFja2dyb3VuZC1jb2xvcjogI2U4ZWFmNjsKfQoKLnNlYXJjaC1ib3ggewogICAgcGFkZGluZzogMXJlbTsKICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZWVlOwp9Cgouc2VhcmNoLWJveCBpbnB1dCB7CiAgICB3aWR0aDogMTAwJTsKICAgIHBhZGRpbmc6IDAuNXJlbTsKICAgIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7CiAgICBib3JkZXItcmFkaXVzOiA0cHg7CiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Owp9CgojcnVsZS1saXN0IHsKICAgIGZsZXg6IDE7CiAgICBvdmVyZmxvdy15OiBhdXRvOwp9CgoucnVsZS1pdGVtIHsKICAgIHBhZGRpbmc6IDFyZW07CiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2VlZTsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4yczsKfQoKLnJ1bGUtaXRlbTpob3ZlciB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjBmMGYwOwp9CgoucnVsZS1pdGVtLmFjdGl2ZSB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZThlYWY2OwogICAgYm9yZGVyLWxlZnQ6IDRweCBzb2xpZCAjM2Y1MWI1Owp9CgoucnVsZS1uYW1lIHsKICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgZGlzcGxheTogYmxvY2s7CiAgICBtYXJnaW4tYm90dG9tOiAwLjI1cmVtOwogICAgd29yZC1icmVhazogYnJlYWstYWxsOwogICAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsKfQoKLnJ1bGUtc3RhdHMgewogICAgZm9udC1zaXplOiAwLjhyZW07CiAgICBjb2xvcjogIzY2NjsKfQoKLmNhcmQgewogICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7CiAgICBwYWRkaW5nOiAxLjVyZW07CiAgICBib3JkZXItcmFkaXVzOiA4cHg7CiAgICBib3gtc2hhZG93OiAwIDFweCAzcHggcmdiYSgwLDAsMCwwLjEpOwogICAgbWFyZ2luLWJvdHRvbTogMnJlbTsKfQoKLmNhcmQgaDIgewogICAgbWFyZ2luLXRvcDogMDsKICAgIGNvbG9yOiAjMzMzOwp9Cgoua2VlcC1ydWxlLXNvdXJjZSB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjhmOGY4OwogICAgcGFkZGluZzogMXJlbTsKICAgIGJvcmRlci1yYWRpdXM6IDRweDsKICAgIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7CiAgICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7CiAgICBib3JkZXItbGVmdDogNHB4IHNvbGlkICMzZjUxYjU7CiAgICBtYXJnaW4tYm90dG9tOiAxcmVtOwp9Cgouc2VjdGlvbi10aXRsZSB7CiAgICBmb250LXNpemU6IDEuMXJlbTsKICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgbWFyZ2luOiAxLjVyZW0gMCAxcmVtIDA7CiAgICBkaXNwbGF5OiBmbGV4OwogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwp9CgouaXRlbS1saXN0IHsKICAgIGxpc3Qtc3R5bGU6IG5vbmU7CiAgICBwYWRkaW5nOiAwOwogICAgbWFyZ2luOiAwOwp9CgouaXRlbS1saXN0IGxpIHsKICAgIHBhZGRpbmc6IDAuNXJlbTsKICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZWVlOwogICAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsKICAgIGZvbnQtc2l6ZTogMC45cmVtOwp9CgouaXRlbS1saXN0IGxpOmxhc3QtY2hpbGQgewogICAgYm9yZGVyLWJvdHRvbTogbm9uZTsKfQoKLmJhZGdlIHsKICAgIGJhY2tncm91bmQtY29sb3I6ICNlZWU7CiAgICBwYWRkaW5nOiAycHggNnB4OwogICAgYm9yZGVyLXJhZGl1czogMTBweDsKICAgIGZvbnQtc2l6ZTogMC43NXJlbTsKICAgIG1hcmdpbi1sZWZ0OiA1cHg7Cn0KCi5iYWRnZS1yZWQgeyBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZlYmVlOyBjb2xvcjogI2M2MjgyODsgfQouYmFkZ2UtYmx1ZSB7IGJhY2tncm91bmQtY29sb3I6ICNlM2YyZmQ7IGNvbG9yOiAjMTU2NWMwOyB9Ci5iYWRnZS1ncmVlbiB7IGJhY2tncm91bmQtY29sb3I6ICNlOGY1ZTk7IGNvbG9yOiAjMmU3ZDMyOyB9CgouYmFubmVyIHsKICAgIHBhZGRpbmc6IDFyZW07CiAgICBib3JkZXItcmFkaXVzOiA0cHg7CiAgICBtYXJnaW4tYm90dG9tOiAxLjVyZW07CiAgICBmb250LXNpemU6IDAuOXJlbTsKfQoKLmJhbm5lci13YXJuaW5nIHsKICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmYzZTA7CiAgICBib3JkZXItbGVmdDogNHB4IHNvbGlkICNmZjk4MDA7CiAgICBjb2xvcjogI2U2NTEwMDsKfQoKLnN1YnN1bWVkLWJ5LWl0ZW0gewogICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjUpOwogICAgcGFkZGluZzogMC41cmVtOwogICAgbWFyZ2luLXRvcDogMC4yNXJlbTsKICAgIGJvcmRlci1yYWRpdXM6IDJweDsKICAgIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7CiAgICB3b3JkLWJyZWFrOiBicmVhay1hbGw7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnM7Cn0KCi5zdWJzdW1lZC1ieS1pdGVtOmhvdmVyIHsKICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC44KTsKfQoKLnNob3ctbW9yZS1idG4gewogICAgZGlzcGxheTogYmxvY2s7CiAgICB3aWR0aDogMTAwJTsKICAgIHBhZGRpbmc6IDAuNzVyZW07CiAgICBtYXJnaW4tdG9wOiAxcmVtOwogICAgYmFja2dyb3VuZC1jb2xvcjogI2Y1ZjVmNTsKICAgIGJvcmRlcjogMXB4IHNvbGlkICNkZGQ7CiAgICBib3JkZXItcmFkaXVzOiA0cHg7CiAgICBjb2xvcjogIzNmNTFiNTsKICAgIGZvbnQtd2VpZ2h0OiA1MDA7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnM7Cn0KCi5zaG93LW1vcmUtYnRuOmhvdmVyIHsKICAgIGJhY2tncm91bmQtY29sb3I6ICNlZWVlZWU7Cn0KCi50YWItYnV0dG9uIC5iYWRnZSB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMik7CiAgICBjb2xvcjogd2hpdGU7CiAgICBtYXJnaW4tbGVmdDogOHB4OwogICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTsKfQoKLnRhYi1idXR0b24uYWN0aXZlIC5iYWRnZSB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTsKICAgIGNvbG9yOiAjM2Y1MWI1Owp9Cgojc3RhdHMtb3ZlcnZpZXcgewogICAgbWFyZ2luLWJvdHRvbTogMnJlbTsKfQoKLnN0YXRzLXRhYmxlIHsKICAgIHdpZHRoOiAxMDAlOwogICAgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsKfQoKLnN0YXRzLXRhYmxlIHRoLCAuc3RhdHMtdGFibGUgdGQgewogICAgcGFkZGluZzogMS4yNXJlbSAxLjVyZW07CiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2VlZTsKfQoKLnN0YXRzLXRhYmxlIHRoIHsKICAgIHRleHQtYWxpZ246IGxlZnQ7CiAgICBmb250LXNpemU6IDAuNzVyZW07CiAgICBmb250LXdlaWdodDogNTAwOwogICAgY29sb3I6ICM2NjY7CiAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOwogICAgbGV0dGVyLXNwYWNpbmc6IDAuMDVlbTsKICAgIGJhY2tncm91bmQtY29sb3I6ICNmYWZhZmE7Cn0KCi5zdGF0cy10YWJsZSB0cjpsYXN0LWNoaWxkIHRkIHsKICAgIGJvcmRlci1ib3R0b206IG5vbmU7Cn0KCi5zdGF0cy10YWJsZSB0ZCB7CiAgICBmb250LXNpemU6IDEuMXJlbTsKICAgIGNvbG9yOiAjM2Y1MWI1OwogICAgZm9udC13ZWlnaHQ6IDUwMDsKfQoKLnN0YXRzLXRhYmxlIHRkOmZpcnN0LWNoaWxkIHsKICAgIGNvbG9yOiAjMzMzOwogICAgZm9udC13ZWlnaHQ6IDQwMDsKfQoKLnN0YXQtY2FyZCB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTsKICAgIHBhZGRpbmc6IDFyZW07CiAgICBib3JkZXItcmFkaXVzOiA4cHg7CiAgICBib3gtc2hhZG93OiAwIDFweCAzcHggcmdiYSgwLDAsMCwwLjEpOwogICAgdGV4dC1hbGlnbjogY2VudGVyOwp9Cgouc3RhdC12YWx1ZSB7CiAgICBmb250LXNpemU6IDEuNXJlbTsKICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgY29sb3I6ICMzZjUxYjU7Cn0KCi5zdGF0LWxhYmVsIHsKICAgIGZvbnQtc2l6ZTogMC44cmVtOwogICAgY29sb3I6ICM2NjY7CiAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOwp9CgouaGlkZGVuIHsKICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKfQoKLnNwaW5uZXIgewogICAgYm9yZGVyOiA0cHggc29saWQgcmdiYSgwLCAwLCAwLCAwLjEpOwogICAgd2lkdGg6IDQ4cHg7CiAgICBoZWlnaHQ6IDQ4cHg7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICBib3JkZXItbGVmdC1jb2xvcjogIzNmNTFiNTsKICAgIGFuaW1hdGlvbjogc3BpbiAxcyBsaW5lYXIgaW5maW5pdGU7CiAgICBtYXJnaW46IDJyZW0gYXV0bzsKfQoKQGtleWZyYW1lcyBzcGluIHsKICAgIDAlIHsgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7IH0KICAgIDEwMCUgeyB0cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpOyB9Cn0KCiNsb2FkaW5nLXNjcmVlbiB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIGhlaWdodDogMTAwJTsKICAgIGNvbG9yOiAjNjY2Owp9Cgouc3ViLXRhYnMgewogICAgZGlzcGxheTogZmxleDsKICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZGRkOwogICAgbWFyZ2luLWJvdHRvbTogMXJlbTsKfQoKLnN1Yi10YWItYnV0dG9uIHsKICAgIGJhY2tncm91bmQ6IG5vbmU7CiAgICBib3JkZXI6IG5vbmU7CiAgICBwYWRkaW5nOiAwLjc1cmVtIDEuNXJlbTsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIGZvbnQtc2l6ZTogMC45cmVtOwogICAgZm9udC13ZWlnaHQ6IDUwMDsKICAgIGNvbG9yOiAjNjY2OwogICAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkIHRyYW5zcGFyZW50Owp9Cgouc3ViLXRhYi1idXR0b246aG92ZXIgewogICAgY29sb3I6ICMzZjUxYjU7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjBmMGYwOwp9Cgouc3ViLXRhYi1idXR0b24uYWN0aXZlIHsKICAgIGNvbG9yOiAjM2Y1MWI1OwogICAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkICMzZjUxYjU7Cn0KPC9zdHlsZT4KICAgIDxsaW5rIGhyZWY9Imh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzMj9mYW1pbHk9Um9ib3RvOndnaHRAMzAwOzQwMDs1MDA7NzAwJmRpc3BsYXk9c3dhcCIgcmVsPSJzdHlsZXNoZWV0Ij4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL3Byb3RvYnVmanNANy4yLjQvZGlzdC9wcm90b2J1Zi5taW4uanMiPjwvc2NyaXB0Pgo8L2hlYWQ+Cjxib2R5PgogICAgPGhlYWRlcj4KICAgICAgICA8aDEgb25jbGljaz0ic3dpdGNoVmlldygncnVsZXMnKSIgc3R5bGU9ImN1cnNvcjogcG9pbnRlcjsiPlI4IEJsYXN0IFJhZGl1cyBWaXN1YWxpemVyPC9oMT4KICAgICAgICA8ZGl2IGlkPSJ0YWJzIj4KICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0idGFiLWJ1dHRvbiBhY3RpdmUiIG9uY2xpY2s9InN3aXRjaFZpZXcoJ3J1bGVzJykiPktlZXAgUnVsZXMgPHNwYW4gaWQ9InJ1bGVzLWNvdW50IiBjbGFzcz0iYmFkZ2UgaGlkZGVuIj4wPC9zcGFuPjwvYnV0dG9uPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJ0YWItYnV0dG9uIiBvbmNsaWNrPSJzd2l0Y2hWaWV3KCdmaWxlcycpIj5LZWVwIFJ1bGUgRmlsZXMgPHNwYW4gaWQ9ImZpbGVzLWNvdW50IiBjbGFzcz0iYmFkZ2UgaGlkZGVuIj4wPC9zcGFuPjwvYnV0dG9uPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJ0YWItYnV0dG9uIiBvbmNsaWNrPSJzd2l0Y2hWaWV3KCd1bnVzZWQnKSI+VW51c2VkIFJ1bGVzIDxzcGFuIGlkPSJ1bnVzZWQtY291bnQiIGNsYXNzPSJiYWRnZSBoaWRkZW4iPjA8L3NwYW4+PC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9InRhYi1idXR0b24iIG9uY2xpY2s9InN3aXRjaFZpZXcoJ3JlZHVuZGFudCcpIj5SZWR1bmRhbnQgUnVsZXMgPHNwYW4gaWQ9InJlZHVuZGFudC1jb3VudCIgY2xhc3M9ImJhZGdlIGhpZGRlbiI+MDwvc3Bhbj48L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGlkPSJmaWxlLWluZm8iPjwvZGl2PgogICAgPC9oZWFkZXI+CgogICAgPGRpdiBpZD0iY29udGFpbmVyIj4KICAgICAgICA8ZGl2IGlkPSJzaWRlYmFyIj4KICAgICAgICAgICAgPGRpdiBpZD0iZHJvcC16b25lIiBjbGFzcz0iaGlkZGVuIj4KICAgICAgICAgICAgICAgIDxwPkRyb3AgYSAucGIgZmlsZSBoZXJlPGJyPm9yIGNsaWNrIHRvIHVwbG9hZDwvcD4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJmaWxlIiBpZD0iZmlsZS1pbnB1dCIgY2xhc3M9ImhpZGRlbiIgYWNjZXB0PSIucGIiPgogICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgIDxkaXYgY2xhc3M9InNlYXJjaC1ib3ggaGlkZGVuIj4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0ic2VhcmNoLWlucHV0IiBwbGFjZWhvbGRlcj0iU2VhcmNoIGtlZXAgcnVsZXMuLi4iPgogICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgIDxkaXYgaWQ9InJ1bGUtbGlzdCI+CiAgICAgICAgICAgICAgICA8IS0tIFJ1bGVzIHdpbGwgYmUgcG9wdWxhdGVkIGhlcmUgLS0+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGlkPSJtYWluLWNvbnRlbnQiPgogICAgICAgICAgICA8ZGl2IGlkPSJsb2FkaW5nLXNjcmVlbiI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzcGlubmVyIj48L2Rpdj4KICAgICAgICAgICAgICAgIDxwPkxvYWRpbmcgYmxhc3QgcmFkaXVzLi4uPC9wPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPHRlbXBsYXRlIGlkPSJzdGF0cy1vdmVydmlldy10ZW1wbGF0ZSI+CiAgICAgICAgICAgIDxkaXYgaWQ9InN0YXRzLW92ZXJ2aWV3Ij4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXQtY2FyZCIgc3R5bGU9Im1hcmdpbi1ib3R0b206IDFyZW07IGRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGNlbnRlcjsiPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXQtbGFiZWwiIHN0eWxlPSJmb250LXNpemU6IDFyZW07Ij5LZWVwIFJ1bGVzPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdC12YWx1ZSIgaWQ9InN0YXQtcnVsZXMiIHN0eWxlPSJmb250LXNpemU6IDJyZW07Ij4wPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNhcmQiIHN0eWxlPSJwYWRkaW5nOiAwOyBvdmVyZmxvdzogaGlkZGVuOyI+CiAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzPSJzdGF0cy10YWJsZSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDx0aGVhZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+SXRlbSBUeXBlPC90aD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGggc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyI+Tm8gb2JmdXNjYXRpb248L3RoPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7Ij5ObyBvcHRpbWl6YXRpb248L3RoPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7Ij5ObyBzaHJpbmtpbmc8L3RoPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7Ij5SZWFjaGFibGU8L3RoPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7Ij5Ub3RhbDwvdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPgogICAgICAgICAgICAgICAgICAgICAgICA8L3RoZWFkPgogICAgICAgICAgICAgICAgICAgICAgICA8dGJvZHk+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPkNsYXNzZXM8L3RkPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBpZD0ic3RhdC1uby1vYmZ1c2NhdGlvbi1jbGFzc2VzIiBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7Ij4wPC90ZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgaWQ9InN0YXQtbm8tb3B0aW1pemF0aW9uLWNsYXNzZXMiIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsiPjA8L3RkPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBpZD0ic3RhdC1uby1zaHJpbmtpbmctY2xhc3NlcyIgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyI+MDwvdGQ+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGlkPSJzdGF0LXJlYWNoYWJsZS1jbGFzc2VzIiBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7Ij4wPC90ZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgaWQ9InN0YXQtdG90YWwtY2xhc3NlcyIgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyI+MDwvdGQ+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD5NZXRob2RzPC90ZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgaWQ9InN0YXQtbm8tb2JmdXNjYXRpb24tbWV0aG9kcyIgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyI+MDwvdGQ+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGlkPSJzdGF0LW5vLW9wdGltaXphdGlvbi1tZXRob2RzIiBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7Ij4wPC90ZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgaWQ9InN0YXQtbm8tc2hyaW5raW5nLW1ldGhvZHMiIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsiPjA8L3RkPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBpZD0ic3RhdC1yZWFjaGFibGUtbWV0aG9kcyIgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyI+MDwvdGQ+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGlkPSJzdGF0LXRvdGFsLW1ldGhvZHMiIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsiPjA8L3RkPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+RmllbGRzPC90ZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgaWQ9InN0YXQtbm8tb2JmdXNjYXRpb24tZmllbGRzIiBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7Ij4wPC90ZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgaWQ9InN0YXQtbm8tb3B0aW1pemF0aW9uLWZpZWxkcyIgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyI+MDwvdGQ+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGlkPSJzdGF0LW5vLXNocmlua2luZy1maWVsZHMiIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsiPjA8L3RkPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBpZD0ic3RhdC1yZWFjaGFibGUtZmllbGRzIiBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7Ij4wPC90ZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgaWQ9InN0YXQtdG90YWwtZmllbGRzIiBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7Ij4wPC90ZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+CiAgICAgICAgICAgICAgICAgICAgPC90YWJsZT4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L3RlbXBsYXRlPgoKICAgICAgICA8dGVtcGxhdGUgaWQ9IndlbGNvbWUtbWVzc2FnZS10ZW1wbGF0ZSI+CiAgICAgICAgICAgIDxkaXYgaWQ9IndlbGNvbWUtbWVzc2FnZSI+CiAgICAgICAgICAgICAgICA8aDI+V2VsY29tZSB0byB0aGUgQmxhc3QgUmFkaXVzIFZpc3VhbGl6ZXI8L2gyPgogICAgICAgICAgICAgICAgPHA+VXBsb2FkIGEgPGNvZGU+LnBiPC9jb2RlPiBmaWxlIGdlbmVyYXRlZCBieSBSOCB3aXRoIHRoZSA8Y29kZT4tcHJpbnRibGFzdHJhZGl1czwvY29kZT4gZmxhZyB0byBzZWUgaG93IHlvdXIga2VlcCBydWxlcyBhZmZlY3QgeW91ciBidWlsZC48L3A+CiAgICAgICAgICAgICAgICA8cD5UaGlzIHRvb2wgaGVscHMgeW91IGlkZW50aWZ5OjwvcD4KICAgICAgICAgICAgICAgIDx1bD4KICAgICAgICAgICAgICAgICAgICA8bGk+S2VlcCBydWxlcyB3aXRoIHRoZSBsYXJnZXN0IGltcGFjdCBvbiB5b3VyIGFwcCBzaXplLjwvbGk+CiAgICAgICAgICAgICAgICAgICAgPGxpPkRlcGVuZGVuY2llcyB0aGF0IGludHJvZHVjZSBicm9hZCBrZWVwIHJ1bGVzLjwvbGk+CiAgICAgICAgICAgICAgICAgICAgPGxpPlJlZHVuZGFudCBrZWVwIHJ1bGVzIHRoYXQgYXJlIHN1YnN1bWVkIGJ5IG90aGVycy48L2xpPgogICAgICAgICAgICAgICAgPC91bD4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC90ZW1wbGF0ZT4KICAgIDwvZGl2PgoKICAgIDxzY3JpcHQgaWQ9ImJsYXN0cmFkaXVzLXByb3RvIiB0eXBlPSJ0ZXh0L3BsYWluIj4vLyBDb3B5cmlnaHQgKGMpIDIwMjYsIHRoZSBSOCBwcm9qZWN0IGF1dGhvcnMuIFBsZWFzZSBzZWUgdGhlIEFVVEhPUlMgZmlsZQovLyBmb3IgZGV0YWlscy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYQovLyBCU0Qtc3R5bGUgbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgpzeW50YXggPSAicHJvdG8zIjsKCnBhY2thZ2UgY29tLmFuZHJvaWQudG9vbHMucjguYmxhc3RyYWRpdXMucHJvdG87CgovLyBEb24ndCBwdXQgYWxsIG1lc3NhZ2VzIHVuZGVyIHRoZSBvdXRlciBjbGFzcy4Kb3B0aW9uIGphdmFfbXVsdGlwbGVfZmlsZXMgPSB0cnVlOwoKLy8gQ2FtZWwtY2FzZSB0aGUgb3V0ZXIgY2xhc3MgbmFtZSAoZGVmYXVsdCBpcyBgQmxhc3RyYWRpdXNgKS4Kb3B0aW9uIGphdmFfb3V0ZXJfY2xhc3NuYW1lID0gIktlZXBSdWxlQmxhc3RSYWRpdXNQcm90b3MiOwoKLy8gSmF2YSBwYWNrYWdlIGNvbnNpc3RlbnQgd2l0aCBSOCBjb252ZW50aW9uLgpvcHRpb24gamF2YV9wYWNrYWdlID0gImNvbS5hbmRyb2lkLnRvb2xzLnI4LmJsYXN0cmFkaXVzLnByb3RvIjsKCi8vIEluZm9ybWF0aW9uIGFib3V0IGEgc2luZ2xlIGtlZXAgcnVsZSBhbmQgaXRzIGltbWVkaWF0ZSBibGFzdCByYWRpdXMuCm1lc3NhZ2UgS2VlcFJ1bGVCbGFzdFJhZGl1cyB7CiAgdWludDMyIGlkID0gMTsKICAvLyBUZXh0dWFsIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBrZWVwIHJ1bGUuCiAgc3RyaW5nIHNvdXJjZSA9IDI7CiAgLy8gV2hhdCB0aGlzIGtlZXAgcnVsZSBwcm9oaWJpdHMgKGUuZy4sIG9wdGltaXphdGlvbikuCiAgLy8gSWQgaW50byBLZWVwQ29uc3RyYWludHMuCiAgdWludDMyIGNvbnN0cmFpbnRzX2lkID0gMzsKICAvLyBXaGVyZSB0aGlzIHJ1bGUgY29tZXMgZnJvbS4KICBUZXh0RmlsZU9yaWdpbiBvcmlnaW4gPSA0OwogIC8vIEJsYXN0IHJhZGl1cyBpbmZvcm1hdGlvbi4KICBCbGFzdFJhZGl1cyBibGFzdF9yYWRpdXMgPSA1OwogIC8vIEtlZXAgcnVsZSB0YWdzLgogIHJlcGVhdGVkIEtlZXBSdWxlVGFnIHRhZ3MgPSA2Owp9CgplbnVtIEtlZXBSdWxlVGFnIHsKICBQQUNLQUdFX1dJREUgPSAwOwp9CgptZXNzYWdlIEJsYXN0UmFkaXVzIHsKICAvLyBXaGljaCBydWxlcyBzdWJzdW1lIHRoaXMgcnVsZS4gTm90ZTogVGhpcyBpbmZvcm1hdGlvbiBjb3VsZCBpbiBwcmluY2lwbGUKICAvLyBiZSBjb21wdXRlZCBvZmZsaW5lIHVzaW5nIHRoZSBrZXB0X2J5IGluZm8gb2YgS2VwdCpJbmZvLgogIC8vIElkcyBpbnRvIEtlZXBBbm5vdGF0aW9uQmxhc3RSYWRpdXMgYW5kIEtlZXBSdWxlQmxhc3RSYWRpdXMuCiAgcmVwZWF0ZWQgdWludDMyIHN1YnN1bWVkX2J5ID0gMTsKICAvLyBUaGUgaW1tZWRpYXRlIGJsYXN0IHJhZGl1cyBvZiB0aGlzIHJ1bGUuCiAgLy8gLSBJZHMgaW50byBLZXB0Q2xhc3NJbmZvLgogIHJlcGVhdGVkIHVpbnQzMiBjbGFzc19ibGFzdF9yYWRpdXMgPSAyOwogIC8vIC0gSWRzIGludG8gS2VwdEZpZWxkSW5mby4KICByZXBlYXRlZCB1aW50MzIgZmllbGRfYmxhc3RfcmFkaXVzID0gMzsKICAvLyAtIElkcyBpbnRvIEtlcHRNZXRob2RJbmZvLgogIHJlcGVhdGVkIHVpbnQzMiBtZXRob2RfYmxhc3RfcmFkaXVzID0gNDsKfQoKLy8gVGhlIGlkcyBvZiBHbG9iYWxLZWVwUnVsZUJsYXN0UmFkaXVzIGFuZCBLZWVwUnVsZUJsYXN0UmFkaXVzIGFyZQovLyBub24tb3ZlcmxhcHBpbmcgYnkgZGVzaWduLCBzbyB0aGF0IGEgc2luZ2xlIHVpbnQzMiBpZCBjYW4gYmUgdXNlZCB0bwovLyB1bmFtYmlndW91c2x5IHJlZmVyZW5jZSBhIEdsb2JhbEtlZXBSdWxlQmxhc3RSYWRpdXMgb3IgS2VlcFJ1bGVCbGFzdFJhZGl1cy4KbWVzc2FnZSBHbG9iYWxLZWVwUnVsZUJsYXN0UmFkaXVzIHsKICB1aW50MzIgaWQgPSAxOwogIC8vIFRleHR1YWwgcmVwcmVzZW50YXRpb24gb2YgdGhlIGtlZXAgcnVsZS4KICBzdHJpbmcgc291cmNlID0gMjsKICAvLyBXaGVyZSB0aGlzIHJ1bGUgY29tZXMgZnJvbS4KICBUZXh0RmlsZU9yaWdpbiBvcmlnaW4gPSAzOwp9CgovLyBJbmZvcm1hdGlvbiBhYm91dCB0aGUgY29uc3RyYWludHMgb2YgYSBzaW5nbGUga2VlcCBhbm5vdGF0aW9uIG9yIHJ1bGUsCi8vIGkuZS4sIHdoYXQgaXMgcHJvaGliaXRlZCBieSBpdC4KLy8KLy8gVGhpcyBpcyBlbmNvZGVkIGFzIGEgbWVzc2FnZSB0byBzdXBwb3J0IGtlZXAgY29uc3RyYWludHMgdGhhdCBjYW5ub3QgYmUKLy8gZW5jb2RlZCBhcyBhIGJpdCBpbiB0aGUgZnV0dXJlLgptZXNzYWdlIEtlZXBDb25zdHJhaW50cyB7CiAgdWludDMyIGlkID0gMTsKICByZXBlYXRlZCBLZWVwQ29uc3RyYWludCBjb25zdHJhaW50cyA9IDI7Cn0KCmVudW0gS2VlcENvbnN0cmFpbnQgewogIERPTlRfT0JGVVNDQVRFID0gMDsKICBET05UX09QVElNSVpFID0gMTsKICBET05UX1NIUklOSyA9IDI7Cn0KCi8vIEluZm9ybWF0aW9uIGFib3V0IGEgY2xhc3MgaW4gdGhlIGFwcC9saWJyYXJ5IGFuZCB3aGljaCBrZWVwIHJ1bGVzIHRoYXQKLy8ga2VlcCBpdC4KbWVzc2FnZSBLZXB0Q2xhc3NJbmZvIHsKICB1aW50MzIgaWQgPSAxOwogIC8vIElkIGludG8gVHlwZVJlZmVyZW5jZS4KICB1aW50MzIgY2xhc3NfcmVmZXJlbmNlX2lkID0gMjsKICAvLyBJZCBpbnRvIEZpbGVPcmlnaW4gb3IgQ2xhc3NGaWxlSW5KYXJPcmlnaW4uCiAgdWludDMyIGZpbGVfb3JpZ2luX2lkID0gMzsKICAvLyBJZHMgaW50byBLZWVwUnVsZUJsYXN0UmFkaXVzLCB0ZWxsaW5nIHdoaWNoIHJ1bGVzIGtlZXAgdGhpcyBjbGFzcy4KICAvLyBBbGxvd3MgcmVhc29uaW5nIGFib3V0IHByb3BlcnRpZXMgc3VjaCBhczoKICAvLyAtIFdoaWNoIGtlZXAgcnVsZXMgYXJlIGZ1bGx5IHN1YnN1bWVkIGJ5IG90aGVyIGtlZXAgcnVsZXM/CiAgLy8gLSBXaGljaCBrZWVwIHJ1bGVzIGtlZXAgdGhlIG1vc3QgY2xhc3Nlcy9maWVsZHMvbWV0aG9kcwogIC8vICAgbm90IGtlcHQgYnkgcnVsZXM/CiAgcmVwZWF0ZWQgdWludDMyIGtlcHRfYnkgPSA0Owp9CgptZXNzYWdlIEtlcHRGaWVsZEluZm8gewogIHVpbnQzMiBpZCA9IDE7CiAgLy8gSWQgaW50byBGaWVsZFJlZmVyZW5jZS4KICB1aW50MzIgZmllbGRfcmVmZXJlbmNlX2lkID0gMjsKICAvLyBJZCBpbnRvIEZpbGVPcmlnaW4gb3IgQ2xhc3NGaWxlSW5KYXJPcmlnaW4uCiAgdWludDMyIGZpbGVfb3JpZ2luX2lkID0gMzsKICAvLyBJZHMgaW50byBLZWVwUnVsZUJsYXN0UmFkaXVzLCB0ZWxsaW5nIHdoaWNoIHJ1bGVzIGtlZXAgdGhpcyBmaWVsZC4KICByZXBlYXRlZCB1aW50MzIga2VwdF9ieSA9IDQ7Cn0KCm1lc3NhZ2UgS2VwdE1ldGhvZEluZm8gewogIHVpbnQzMiBpZCA9IDE7CiAgLy8gSWQgaW50byBNZXRob2RSZWZlcmVuY2UuCiAgdWludDMyIG1ldGhvZF9yZWZlcmVuY2VfaWQgPSAyOwogIC8vIElkIGludG8gRmlsZU9yaWdpbiBvciBDbGFzc0ZpbGVJbkphck9yaWdpbi4KICB1aW50MzIgZmlsZV9vcmlnaW5faWQgPSAzOwogIC8vIElkcyBpbnRvIEtlZXBSdWxlQmxhc3RSYWRpdXMsIHRlbGxpbmcgd2hpY2ggcnVsZXMga2VlcCB0aGlzIG1ldGhvZC4KICByZXBlYXRlZCB1aW50MzIga2VwdF9ieSA9IDQ7Cn0KCi8vIFJlZmVyZW5jZXM6CgptZXNzYWdlIEZpZWxkUmVmZXJlbmNlIHsKICB1aW50MzIgaWQgPSAxOwogIC8vIFRoZSBjbGFzcyBvbiB3aGljaCB0aGUgZmllbGQgaXMgZGVjbGFyZWQuCiAgLy8gSWQgaW50byBUeXBlUmVmZXJlbmNlLgogIHVpbnQzMiBjbGFzc19yZWZlcmVuY2VfaWQgPSAyOwogIC8vIFRoZSB0eXBlIG9mIHRoZSBmaWVsZC4KICAvLyBJZCBpbnRvIHR5cGUgcmVmZXJlbmNlLgogIHVpbnQzMiB0eXBlX3JlZmVyZW5jZV9pZCA9IDM7CiAgLy8gVGhlIG5hbWUgb2YgdGhlIGZpZWxkLgogIHN0cmluZyBuYW1lID0gNDsKfQoKbWVzc2FnZSBNZXRob2RSZWZlcmVuY2UgewogIHVpbnQzMiBpZCA9IDE7CiAgLy8gVGhlIGNsYXNzIG9uIHdoaWNoIHRoZSBtZXRob2QgaXMgZGVjbGFyZWQuCiAgLy8gSWQgaW50byBUeXBlUmVmZXJlbmNlLgogIHVpbnQzMiBjbGFzc19yZWZlcmVuY2VfaWQgPSAyOwogIC8vIFRoZSBwcm90byAocmV0dXJuIHR5cGUsIHBhcmFtZXRlciB0eXBlcykgb2YgdGhlIG1ldGhvZC4KICAvLyBJZCBpbnRvIFByb3RvUmVmZXJlbmNlLgogIHVpbnQzMiBwcm90b19yZWZlcmVuY2VfaWQgPSAzOwogIC8vIFRoZSBuYW1lIG9mIHRoZSBtZXRob2QuCiAgc3RyaW5nIG5hbWUgPSA0Owp9CgptZXNzYWdlIFByb3RvUmVmZXJlbmNlIHsKICB1aW50MzIgaWQgPSAxOwogIC8vIElkIGludG8gVHlwZVJlZmVyZW5jZUxpc3QuCiAgdWludDMyIHBhcmFtZXRlcnNfaWQgPSAyOwogIC8vIElkIGludG8gVHlwZVJlZmVyZW5jZS4KICB1aW50MzIgcmV0dXJuX3R5cGVfaWQgPSAzOwp9CgptZXNzYWdlIFR5cGVSZWZlcmVuY2UgewogIHVpbnQzMiBpZCA9IDE7CiAgLy8gVGhlIGRlc2NyaXB0b3IsIGUuZy4sCiAgLy8gLSBaCiAgLy8gLSBMamF2YS9sYW5nL09iamVjdDsKICAvLyAtIFtbTGphdmEvbGFuZy9PYmplY3Q7CiAgc3RyaW5nIGphdmFfZGVzY3JpcHRvciA9IDI7Cn0KCm1lc3NhZ2UgVHlwZVJlZmVyZW5jZUxpc3QgewogIHVpbnQzMiBpZCA9IDE7CiAgcmVwZWF0ZWQgdWludDMyIHR5cGVfcmVmZXJlbmNlX2lkcyA9IDI7Cn0KCi8vIE9yaWdpbnM6CgptZXNzYWdlIEZpbGVPcmlnaW4gewogIHVpbnQzMiBpZCA9IDE7CiAgc3RyaW5nIGZpbGVuYW1lID0gMjsKICBNYXZlbkNvb3JkaW5hdGUgbWF2ZW5fY29vcmRpbmF0ZSA9IDM7Cn0KCi8vIFRoZSBpZHMgb2YgQ2xhc3NGaWxlSW5KYXJPcmlnaW4gYW5kIEZpbGVPcmlnaW4gYXJlIG5vbi1vdmVybGFwcGluZwovLyBieSBkZXNpZ24sIHNvIHRoYXQgYSBzaW5nbGUgdWludDMyIGlkIGNhbiBiZSB1c2VkIHRvCi8vIHVuYW1iaWd1b3VzbHkgcmVmZXJlbmNlIGEgQ2xhc3NGaWxlSW5KYXJPcmlnaW4gb3IgRmlsZU9yaWdpbi4KbWVzc2FnZSBDbGFzc0ZpbGVJbkphck9yaWdpbiB7CiAgdWludDMyIGlkID0gMTsKICB1aW50MzIgZmlsZV9vcmlnaW5faWQgPSAyOwogIHN0cmluZyBlbnRyeSA9IDM7Cn0KCi8vIEludGVudGlvbmFsbHkgZG9lc24ndCBkZWNsYXJlIGFuIGlkIHNpbmNlIGVhY2gga2VlcCBydWxlIGhhcyBpdHMgb3duCi8vIFRleHRGaWxlT3JpZ2luLCBpLmUuLCB0aGVyZSBpcyBubyBzaGFyaW5nIG9mIFRleHRGaWxlT3JpZ2luLgptZXNzYWdlIFRleHRGaWxlT3JpZ2luIHsKICAvLyBJZCBpbnRvIEZpbGVPcmlnaW4KICB1aW50MzIgZmlsZV9vcmlnaW5faWQgPSAxOwogIHVpbnQzMiBsaW5lX251bWJlciA9IDI7CiAgdWludDMyIGNvbHVtbl9udW1iZXIgPSAzOwp9CgptZXNzYWdlIE1hdmVuQ29vcmRpbmF0ZSB7CiAgdWludDMyIGlkID0gMTsKICBzdHJpbmcgZ3JvdXBfaWQgPSAyOwogIHN0cmluZyBhcnRpZmFjdF9pZCA9IDM7CiAgc3RyaW5nIHZlcnNpb24gPSA0Owp9CgptZXNzYWdlIEJ1aWxkSW5mbyB7CiAgdWludDMyIGNsYXNzX2NvdW50ID0gMTsKICB1aW50MzIgZmllbGRfY291bnQgPSAyOwogIHVpbnQzMiBtZXRob2RfY291bnQgPSAzOwogIHVpbnQzMiBsaXZlX2NsYXNzX2NvdW50ID0gNDsKICB1aW50MzIgbGl2ZV9maWVsZF9jb3VudCA9IDU7CiAgdWludDMyIGxpdmVfbWV0aG9kX2NvdW50ID0gNjsKfQoKLy8gQ29udGFpbmVyLgoKbWVzc2FnZSBCbGFzdFJhZGl1c0NvbnRhaW5lciB7CiAgLy8gT3JpZ2lucy4KICByZXBlYXRlZCBGaWxlT3JpZ2luIGZpbGVfb3JpZ2luX3RhYmxlID0gMTsKICByZXBlYXRlZCBDbGFzc0ZpbGVJbkphck9yaWdpbiBjbGFzc19maWxlX2luX2phcl9vcmlnaW5fdGFibGUgPSAyOwogIHJlcGVhdGVkIE1hdmVuQ29vcmRpbmF0ZSBtYXZlbl9jb29yZGluYXRlX3RhYmxlID0gMzsKCiAgLy8gUmVmZXJlbmNlcy4KICByZXBlYXRlZCBGaWVsZFJlZmVyZW5jZSBmaWVsZF9yZWZlcmVuY2VfdGFibGUgPSA0OwogIHJlcGVhdGVkIE1ldGhvZFJlZmVyZW5jZSBtZXRob2RfcmVmZXJlbmNlX3RhYmxlID0gNTsKICByZXBlYXRlZCBQcm90b1JlZmVyZW5jZSBwcm90b19yZWZlcmVuY2VfdGFibGUgPSA2OwogIHJlcGVhdGVkIFR5cGVSZWZlcmVuY2UgdHlwZV9yZWZlcmVuY2VfdGFibGUgPSA3OwogIHJlcGVhdGVkIFR5cGVSZWZlcmVuY2VMaXN0IHR5cGVfcmVmZXJlbmNlX2xpc3RfdGFibGUgPSA4OwoKICAvLyBLZXB0IGl0ZW1zLgogIHJlcGVhdGVkIEtlcHRDbGFzc0luZm8ga2VwdF9jbGFzc19pbmZvX3RhYmxlID0gOTsKICByZXBlYXRlZCBLZXB0RmllbGRJbmZvIGtlcHRfZmllbGRfaW5mb190YWJsZSA9IDEwOwogIHJlcGVhdGVkIEtlcHRNZXRob2RJbmZvIGtlcHRfbWV0aG9kX2luZm9fdGFibGUgPSAxMTsKCiAgLy8gS2VlcCBzcGVjaWZpY2F0aW9ucy4KICByZXBlYXRlZCBLZWVwQ29uc3RyYWludHMga2VlcF9jb25zdHJhaW50c190YWJsZSA9IDEyOwogIHJlcGVhdGVkIEtlZXBSdWxlQmxhc3RSYWRpdXMga2VlcF9ydWxlX2JsYXN0X3JhZGl1c190YWJsZSA9IDEzOwogIHJlcGVhdGVkIEdsb2JhbEtlZXBSdWxlQmxhc3RSYWRpdXMgZ2xvYmFsX2tlZXBfcnVsZV9ibGFzdF9yYWRpdXNfdGFibGUgPSAxNDsKCiAgLy8gQnVpbGQgaW5mby4KICBCdWlsZEluZm8gYnVpbGRfaW5mbyA9IDE1Owp9Cjwvc2NyaXB0PjxzY3JpcHQgaWQ9ImJsYXN0cmFkaXVzLWRhdGEiIHR5cGU9ImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSI+PC9zY3JpcHQ+PHNjcmlwdD4vLyBDb3B5cmlnaHQgKGMpIDIwMjYsIHRoZSBSOCBwcm9qZWN0IGF1dGhvcnMuIFBsZWFzZSBzZWUgdGhlIEFVVEhPUlMgZmlsZQovLyBmb3IgZGV0YWlscy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYQovLyBCU0Qtc3R5bGUgbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgpsZXQgcHJvdG9idWZSb290ID0gbnVsbDsKbGV0IGNvbnRhaW5lckRhdGEgPSBudWxsOwpsZXQgZmlsdGVyZWRSdWxlcyA9IFtdOwpsZXQgZmlsdGVyZWRGaWxlcyA9IFtdOwpsZXQgY3VycmVudFZpZXcgPSAncnVsZXMnOyAvLyAncnVsZXMnLCAnZmlsZXMnLCAndW51c2VkJywgJ3JlZHVuZGFudCcKbGV0IGN1cnJlbnRTdWJWaWV3ID0gJ2NsYXNzJzsgLy8gJ2NsYXNzJywgJ21ldGhvZCcsICdmaWVsZCcKbGV0IGN1cnJlbnRTZWxlY3RlZFJ1bGUgPSBudWxsOwpsZXQgY3VycmVudFJ1bGVQYWdpbmF0aW9uID0gewogIGNsYXNzZXM6IDEwMCwKICBtZXRob2RzOiAxMDAsCiAgZmllbGRzOiAxMDAKfTsKCi8vIExvb2t1cCBtYXBzCmxldCB0YWJsZXMgPSB7CiAgcnVsZXM6IG5ldyBNYXAoKSwKICBjbGFzc2VzOiBuZXcgTWFwKCksCiAgZmllbGRzOiBuZXcgTWFwKCksCiAgbWV0aG9kczogbmV3IE1hcCgpLAogIHR5cGVzOiBuZXcgTWFwKCksCiAgcHJvdG9zOiBuZXcgTWFwKCksCiAgdHlwZUxpc3RzOiBuZXcgTWFwKCksCiAgb3JpZ2luczogbmV3IE1hcCgpLAogIGphck9yaWdpbnM6IG5ldyBNYXAoKSwKICBrZWVwQ29uc3RyYWludHM6IG5ldyBNYXAoKSwKICBmaWxlczogbmV3IE1hcCgpLCAvLyBmaWxlbmFtZSAtPiB7IHJ1bGVzOiBbXSwgdG90YWxSYWRpdXM6IDAsIGNsYXNzZXM6IDAsIG1ldGhvZHM6IDAsIGZpZWxkczogMCB9CiAgbWV0aG9kUmVmczogbmV3IE1hcCgpLAogIGZpZWxkUmVmczogbmV3IE1hcCgpCn07CgpsZXQgY29uc3RyYWludFN0YXRzID0gewogIERPTlRfT0JGVVNDQVRFOiB7CiAgICBjbGFzc2VzOiBuZXcgU2V0KCksCiAgICBtZXRob2RzOiBuZXcgU2V0KCksCiAgICBmaWVsZHM6IG5ldyBTZXQoKQogIH0sCiAgRE9OVF9PUFRJTUlaRTogewogICAgY2xhc3NlczogbmV3IFNldCgpLAogICAgbWV0aG9kczogbmV3IFNldCgpLAogICAgZmllbGRzOiBuZXcgU2V0KCkKICB9LAogIERPTlRfU0hSSU5LOiB7CiAgICBjbGFzc2VzOiBuZXcgU2V0KCksCiAgICBtZXRob2RzOiBuZXcgU2V0KCksCiAgICBmaWVsZHM6IG5ldyBTZXQoKQogIH0KfTsKCmNvbnN0IGRyb3Bab25lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Atem9uZScpOwpjb25zdCBmaWxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZS1pbnB1dCcpOwpjb25zdCBydWxlTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdydWxlLWxpc3QnKTsKY29uc3Qgc2VhcmNoSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VhcmNoLWlucHV0Jyk7CmNvbnN0IG1haW5Db250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4tY29udGVudCcpOwoKY29uc3QgZW1iZWRkZWRQcm90b1NjaGVtYVNvdXJjZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdibGFzdHJhZGl1cy1wcm90bycpOwpjb25zdCBlbWJlZGRlZFByb3RvRGF0YVNvdXJjZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdibGFzdHJhZGl1cy1kYXRhJyk7CgovLyBMb2FkIFByb3RvYnVmIGRlZmluaXRpb24uCmlmIChlbWJlZGRlZFByb3RvU2NoZW1hU291cmNlKSB7CiAgdHJ5IHsKICAgIHByb3RvYnVmUm9vdCA9IHByb3RvYnVmLnBhcnNlKGVtYmVkZGVkUHJvdG9TY2hlbWFTb3VyY2UudGV4dENvbnRlbnQpLnJvb3Q7CiAgfSBjYXRjaCAoZSkgewogICAgY29uc29sZS5lcnJvcigiRmFpbGVkIHRvIHBhcnNlIGVtYmVkZGVkIHByb3RvOiIsIGUpOwogIH0KfSBlbHNlIHsKICBwcm90b2J1Zi5sb2FkKCJibGFzdHJhZGl1cy5wcm90byIsIGZ1bmN0aW9uKGVyciwgcm9vdCkgewogICAgaWYgKGVycikgewogICAgICBjb25zb2xlLmVycm9yKCJFcnJvciBsb2FkaW5nIHByb3RvOiIsIGVycik7CiAgICAgIGFsZXJ0KCJGYWlsZWQgdG8gbG9hZCBibGFzdHJhZGl1cy5wcm90by4iKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgcHJvdG9idWZSb290ID0gcm9vdDsKICB9KTsKfQoKLy8gTG9hZCBibGFzdCByYWRpdXMgZGF0YSAoLnBiKS4KaWYgKGVtYmVkZGVkUHJvdG9EYXRhU291cmNlKSB7CiAgc2V0VGltZW91dCgoKSA9PiB7CiAgICB0cnkgewogICAgICBjb25zdCBkYXRhID0gZW1iZWRkZWRQcm90b0RhdGFTb3VyY2UudGV4dENvbnRlbnQudHJpbSgpOwogICAgICBjb25zdCBieXRlcyA9IFVpbnQ4QXJyYXkuZnJvbShhdG9iKGRhdGEpLCBjID0+IGMuY2hhckNvZGVBdCgwKSk7CiAgICAgIGNvbnN0IEJsYXN0UmFkaXVzQ29udGFpbmVyID0gcHJvdG9idWZSb290Lmxvb2t1cFR5cGUoImNvbS5hbmRyb2lkLnRvb2xzLnI4LmJsYXN0cmFkaXVzLnByb3RvLkJsYXN0UmFkaXVzQ29udGFpbmVyIik7CiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBCbGFzdFJhZGl1c0NvbnRhaW5lci5kZWNvZGUoYnl0ZXMpOwogICAgICBjb250YWluZXJEYXRhID0gQmxhc3RSYWRpdXNDb250YWluZXIudG9PYmplY3QobWVzc2FnZSwgewogICAgICAgIGxvbmdzOiBTdHJpbmcsCiAgICAgICAgZW51bXM6IFN0cmluZywKICAgICAgICBieXRlczogU3RyaW5nLAogICAgICAgIGRlZmF1bHRzOiB0cnVlLAogICAgICAgIGFycmF5czogdHJ1ZSwKICAgICAgICBvYmplY3RzOiB0cnVlLAogICAgICAgIG9uZW9mczogdHJ1ZQogICAgICB9KTsKICAgICAgcHJvY2Vzc0RhdGEoKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgY29uc29sZS5lcnJvcigiRmFpbGVkIHRvIGRlY29kZSBlbWJlZGRlZCBkYXRhOiIsIGUpOwogICAgfQogIH0sIDApOwp9IGVsc2UgewogIGRyb3Bab25lLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gZmlsZUlucHV0LmNsaWNrKCkpOwoKICBkcm9wWm9uZS5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIChlKSA9PiB7CiAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICBkcm9wWm9uZS5jbGFzc0xpc3QuYWRkKCdob3ZlcicpOwogIH0pOwoKICBkcm9wWm9uZS5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCAoKSA9PiB7CiAgICBkcm9wWm9uZS5jbGFzc0xpc3QucmVtb3ZlKCdob3ZlcicpOwogIH0pOwoKICBkcm9wWm9uZS5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgKGUpID0+IHsKICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgIGRyb3Bab25lLmNsYXNzTGlzdC5yZW1vdmUoJ2hvdmVyJyk7CiAgICBpZiAoZS5kYXRhVHJhbnNmZXIuZmlsZXMubGVuZ3RoID4gMCkgewogICAgICBoYW5kbGVGaWxlKGUuZGF0YVRyYW5zZmVyLmZpbGVzWzBdKTsKICAgIH0KICB9KTsKCiAgZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7CiAgICBpZiAoZS50YXJnZXQuZmlsZXMubGVuZ3RoID4gMCkgewogICAgICBoYW5kbGVGaWxlKGUudGFyZ2V0LmZpbGVzWzBdKTsKICAgIH0KICB9KTsKCiAgZnVuY3Rpb24gaGFuZGxlRmlsZShmaWxlKSB7CiAgICBpZiAoIXByb3RvYnVmUm9vdCkgewogICAgICBhbGVydCgiUHJvdG9idWYgZGVmaW5pdGlvbiBub3QgbG9hZGVkIHlldC4iKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHJlbmRlckxvYWRpbmcoKTsKICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24oZSkgewogICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IGUudGFyZ2V0LnJlc3VsdDsKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IEJsYXN0UmFkaXVzQ29udGFpbmVyID0gcHJvdG9idWZSb290Lmxvb2t1cFR5cGUoImNvbS5hbmRyb2lkLnRvb2xzLnI4LmJsYXN0cmFkaXVzLnByb3RvLkJsYXN0UmFkaXVzQ29udGFpbmVyIik7CiAgICAgICAgICBjb25zdCBidWZmZXIgPSBuZXcgVWludDhBcnJheShhcnJheUJ1ZmZlcik7CiAgICAgICAgICBjb25zdCBtZXNzYWdlID0gQmxhc3RSYWRpdXNDb250YWluZXIuZGVjb2RlKGJ1ZmZlcik7CiAgICAgICAgICBjb250YWluZXJEYXRhID0gQmxhc3RSYWRpdXNDb250YWluZXIudG9PYmplY3QobWVzc2FnZSwgewogICAgICAgICAgICBsb25nczogU3RyaW5nLAogICAgICAgICAgICBlbnVtczogU3RyaW5nLAogICAgICAgICAgICBieXRlczogU3RyaW5nLAogICAgICAgICAgICBkZWZhdWx0czogdHJ1ZSwKICAgICAgICAgICAgYXJyYXlzOiB0cnVlLAogICAgICAgICAgICBvYmplY3RzOiB0cnVlLAogICAgICAgICAgICBvbmVvZnM6IHRydWUKICAgICAgICAgIH0pOwogICAgICAgICAgcHJvY2Vzc0RhdGEoKTsKICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGRlY29kaW5nIHByb3RvOiIsIGVycik7CiAgICAgICAgICBhbGVydCgiRmFpbGVkIHRvIGRlY29kZSB0aGUgLnBiIGZpbGUuIEVuc3VyZSBpdCBtYXRjaGVzIHRoZSBibGFzdHJhZGl1cy5wcm90byBzY2hlbWEuIik7CiAgICAgICAgICByZW5kZXJXZWxjb21lTWVzc2FnZSgpOwogICAgICAgICAgZHJvcFpvbmUuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICAgICAgfQogICAgICB9LCAwKTsKICAgIH07CiAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZmlsZSk7CiAgfQp9CgpzZWFyY2hJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIChlKSA9PiB7CiAgaWYgKGN1cnJlbnRWaWV3ID09PSAncnVsZXMnKSB7CiAgICBmaWx0ZXJSdWxlcyhlLnRhcmdldC52YWx1ZSk7CiAgfSBlbHNlIGlmIChjdXJyZW50VmlldyA9PT0gJ3VudXNlZCcpIHsKICAgIGZpbHRlclVudXNlZFJ1bGVzKGUudGFyZ2V0LnZhbHVlKTsKICB9IGVsc2UgaWYgKGN1cnJlbnRWaWV3ID09PSAncmVkdW5kYW50JykgewogICAgZmlsdGVyUmVkdW5kYW50UnVsZXMoZS50YXJnZXQudmFsdWUpOwogIH0gZWxzZSBpZiAoY3VycmVudFZpZXcgPT09ICdmaWxlcycpIHsKICAgIGZpbHRlckZpbGVzKGUudGFyZ2V0LnZhbHVlKTsKICB9Cn0pOwoKZnVuY3Rpb24gcHJvY2Vzc0RhdGEoKSB7CiAgLy8gQ2xlYXIgcHJldmlvdXMgZGF0YQogIE9iamVjdC52YWx1ZXModGFibGVzKS5mb3JFYWNoKG1hcCA9PiBtYXAgaW5zdGFuY2VvZiBNYXAgPyBtYXAuY2xlYXIoKSA6IG51bGwpOwogIHRhYmxlcy5maWxlcyA9IG5ldyBNYXAoKTsKCiAgLy8gUmVzZXQgY29uc3RyYWludCBzdGF0cwogIE9iamVjdC52YWx1ZXMoY29uc3RyYWludFN0YXRzKS5mb3JFYWNoKHMgPT4gewogICAgcy5jbGFzc2VzLmNsZWFyKCk7CiAgICBzLm1ldGhvZHMuY2xlYXIoKTsKICAgIHMuZmllbGRzLmNsZWFyKCk7CiAgfSk7CgogIC8vIEJ1aWxkIGxvb2t1cCB0YWJsZXMgZm9yIG9yaWdpbnMKICBpZiAoY29udGFpbmVyRGF0YS5jbGFzc0ZpbGVJbkphck9yaWdpblRhYmxlKQogICAgY29udGFpbmVyRGF0YS5jbGFzc0ZpbGVJbkphck9yaWdpblRhYmxlLmZvckVhY2gobyA9PiB0YWJsZXMuamFyT3JpZ2lucy5zZXQoby5pZCwgbykpOwogIGlmIChjb250YWluZXJEYXRhLmZpbGVPcmlnaW5UYWJsZSkKICAgIGNvbnRhaW5lckRhdGEuZmlsZU9yaWdpblRhYmxlLmZvckVhY2gobyA9PiB0YWJsZXMub3JpZ2lucy5zZXQoby5pZCwgbykpOwoKICAvLyBCdWlsZCBsb29rdXAgdGFibGUgZm9yIHJlZmVyZW5jZXMuCiAgaWYgKGNvbnRhaW5lckRhdGEuZmllbGRSZWZlcmVuY2VUYWJsZSkKICAgIGNvbnRhaW5lckRhdGEuZmllbGRSZWZlcmVuY2VUYWJsZS5mb3JFYWNoKGYgPT4gdGFibGVzLmZpZWxkUmVmcy5zZXQoZi5pZCwgZikpOwogIGlmIChjb250YWluZXJEYXRhLm1ldGhvZFJlZmVyZW5jZVRhYmxlKQogICAgY29udGFpbmVyRGF0YS5tZXRob2RSZWZlcmVuY2VUYWJsZS5mb3JFYWNoKG0gPT4gdGFibGVzLm1ldGhvZFJlZnMuc2V0KG0uaWQsIG0pKTsKICBpZiAoY29udGFpbmVyRGF0YS5wcm90b1JlZmVyZW5jZVRhYmxlKQogICAgY29udGFpbmVyRGF0YS5wcm90b1JlZmVyZW5jZVRhYmxlLmZvckVhY2gocCA9PiB0YWJsZXMucHJvdG9zLnNldChwLmlkLCBwKSk7CiAgaWYgKGNvbnRhaW5lckRhdGEudHlwZVJlZmVyZW5jZVRhYmxlKQogICAgY29udGFpbmVyRGF0YS50eXBlUmVmZXJlbmNlVGFibGUuZm9yRWFjaCh0ID0+IHRhYmxlcy50eXBlcy5zZXQodC5pZCwgdCkpOwogIGlmIChjb250YWluZXJEYXRhLnR5cGVSZWZlcmVuY2VMaXN0VGFibGUpCiAgICBjb250YWluZXJEYXRhLnR5cGVSZWZlcmVuY2VMaXN0VGFibGUuZm9yRWFjaCh0bCA9PiB0YWJsZXMudHlwZUxpc3RzLnNldCh0bC5pZCwgdGwpKTsKCiAgLy8gQnVpbGQgbG9va3VwIHRhYmxlcyBmb3Iga2VwdCBpdGVtcwogIGlmIChjb250YWluZXJEYXRhLmtlcHRDbGFzc0luZm9UYWJsZSkKICAgIGNvbnRhaW5lckRhdGEua2VwdENsYXNzSW5mb1RhYmxlLmZvckVhY2goYyA9PiB0YWJsZXMuY2xhc3Nlcy5zZXQoYy5pZCwgYykpOwogIGlmIChjb250YWluZXJEYXRhLmtlcHRGaWVsZEluZm9UYWJsZSkKICAgIGNvbnRhaW5lckRhdGEua2VwdEZpZWxkSW5mb1RhYmxlLmZvckVhY2goZiA9PiB0YWJsZXMuZmllbGRzLnNldChmLmlkLCBmKSk7CiAgaWYgKGNvbnRhaW5lckRhdGEua2VwdE1ldGhvZEluZm9UYWJsZSkKICAgIGNvbnRhaW5lckRhdGEua2VwdE1ldGhvZEluZm9UYWJsZS5mb3JFYWNoKG0gPT4gdGFibGVzLm1ldGhvZHMuc2V0KG0uaWQsIG0pKTsKCiAgaWYgKGNvbnRhaW5lckRhdGEua2VlcENvbnN0cmFpbnRzVGFibGUpCiAgICBjb250YWluZXJEYXRhLmtlZXBDb25zdHJhaW50c1RhYmxlLmZvckVhY2goYyA9PiB0YWJsZXMua2VlcENvbnN0cmFpbnRzLnNldChjLmlkLCBjKSk7CgogIGlmIChjb250YWluZXJEYXRhLmtlZXBSdWxlQmxhc3RSYWRpdXNUYWJsZSkgewogICAgY29udGFpbmVyRGF0YS5rZWVwUnVsZUJsYXN0UmFkaXVzVGFibGUuZm9yRWFjaChyID0+IHsKICAgICAgdGFibGVzLnJ1bGVzLnNldChyLmlkLCByKTsKICAgICAgci50b3RhbFJhZGl1cyA9IChyLmJsYXN0UmFkaXVzLmNsYXNzQmxhc3RSYWRpdXM/Lmxlbmd0aCB8fCAwKSArCiAgICAgICAgKHIuYmxhc3RSYWRpdXMuZmllbGRCbGFzdFJhZGl1cz8ubGVuZ3RoIHx8IDApICsKICAgICAgICAoci5ibGFzdFJhZGl1cy5tZXRob2RCbGFzdFJhZGl1cz8ubGVuZ3RoIHx8IDApOwoKICAgICAgLy8gUG9wdWxhdGUgY29uc3RyYWludCBzdGF0cwogICAgICBjb25zdCBjb25zdHJhaW50cyA9IHRhYmxlcy5rZWVwQ29uc3RyYWludHMuZ2V0KHIuY29uc3RyYWludHNJZCk7CiAgICAgIGlmIChjb25zdHJhaW50cyAmJiBjb25zdHJhaW50cy5jb25zdHJhaW50cykgewogICAgICAgIGNvbnN0cmFpbnRzLmNvbnN0cmFpbnRzLmZvckVhY2goYyA9PiB7CiAgICAgICAgICBjb25zdCBzdGF0cyA9IGNvbnN0cmFpbnRTdGF0c1tjXTsKICAgICAgICAgIGlmIChzdGF0cykgewogICAgICAgICAgICByLmJsYXN0UmFkaXVzLmNsYXNzQmxhc3RSYWRpdXM/LmZvckVhY2goaWQgPT4gc3RhdHMuY2xhc3Nlcy5hZGQoaWQpKTsKICAgICAgICAgICAgci5ibGFzdFJhZGl1cy5tZXRob2RCbGFzdFJhZGl1cz8uZm9yRWFjaChpZCA9PiBzdGF0cy5tZXRob2RzLmFkZChpZCkpOwogICAgICAgICAgICByLmJsYXN0UmFkaXVzLmZpZWxkQmxhc3RSYWRpdXM/LmZvckVhY2goaWQgPT4gc3RhdHMuZmllbGRzLmFkZChpZCkpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CgogICAgICAvLyBHcm91cCBieSBmaWxlCiAgICAgIGNvbnN0IGZpbGVOYW1lID0gZ2V0RmlsZU5hbWUoci5vcmlnaW4pOwogICAgICBpZiAoIXRhYmxlcy5maWxlcy5oYXMoZmlsZU5hbWUpKSB7CiAgICAgICAgdGFibGVzLmZpbGVzLnNldChmaWxlTmFtZSwgewogICAgICAgICAgbmFtZTogZmlsZU5hbWUsCiAgICAgICAgICBvcmlnaW46IHIub3JpZ2luLAogICAgICAgICAgcnVsZXM6IFtdLAogICAgICAgICAgY2xhc3NJZHM6IG5ldyBTZXQoKSwKICAgICAgICAgIG1ldGhvZElkczogbmV3IFNldCgpLAogICAgICAgICAgZmllbGRJZHM6IG5ldyBTZXQoKQogICAgICAgIH0pOwogICAgICB9CiAgICAgIGNvbnN0IGZpbGVEYXRhID0gdGFibGVzLmZpbGVzLmdldChmaWxlTmFtZSk7CiAgICAgIGZpbGVEYXRhLnJ1bGVzLnB1c2gocik7CiAgICAgIHIuYmxhc3RSYWRpdXMuY2xhc3NCbGFzdFJhZGl1cz8uZm9yRWFjaChpZCA9PiBmaWxlRGF0YS5jbGFzc0lkcy5hZGQoaWQpKTsKICAgICAgci5ibGFzdFJhZGl1cy5tZXRob2RCbGFzdFJhZGl1cz8uZm9yRWFjaChpZCA9PiBmaWxlRGF0YS5tZXRob2RJZHMuYWRkKGlkKSk7CiAgICAgIHIuYmxhc3RSYWRpdXMuZmllbGRCbGFzdFJhZGl1cz8uZm9yRWFjaChpZCA9PiBmaWxlRGF0YS5maWVsZElkcy5hZGQoaWQpKTsKICAgIH0pOwoKICAgIC8vIENvbXB1dGUgZmluYWwgY291bnRzIGZvciBmaWxlcwogICAgdGFibGVzLmZpbGVzLmZvckVhY2goZmlsZURhdGEgPT4gewogICAgICBmaWxlRGF0YS5jbGFzc2VzID0gZmlsZURhdGEuY2xhc3NJZHMuc2l6ZTsKICAgICAgZmlsZURhdGEubWV0aG9kcyA9IGZpbGVEYXRhLm1ldGhvZElkcy5zaXplOwogICAgICBmaWxlRGF0YS5maWVsZHMgPSBmaWxlRGF0YS5maWVsZElkcy5zaXplOwogICAgICBmaWxlRGF0YS50b3RhbFJhZGl1cyA9IGZpbGVEYXRhLmNsYXNzZXMgKyBmaWxlRGF0YS5tZXRob2RzICsgZmlsZURhdGEuZmllbGRzOwogICAgfSk7CiAgfQoKICBkcm9wWm9uZS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VhcmNoLWJveCcpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOwogIHN3aXRjaFZpZXcoJ3J1bGVzJyk7Cn0KCmZ1bmN0aW9uIHJlbmRlclN0YXRzKCkgewogIGNvbnN0IHJ1bGVzID0gY29udGFpbmVyRGF0YS5rZWVwUnVsZUJsYXN0UmFkaXVzVGFibGUgfHwgW107CiAgY29uc3QgdW51c2VkQ291bnQgPSBydWxlcy5maWx0ZXIociA9PiByLnRvdGFsUmFkaXVzID09PSAwKS5sZW5ndGg7CiAgY29uc3QgcmVkdW5kYW50Q291bnQgPSBydWxlcy5maWx0ZXIociA9PiByLmJsYXN0UmFkaXVzLnN1YnN1bWVkQnkgJiYgci5ibGFzdFJhZGl1cy5zdWJzdW1lZEJ5Lmxlbmd0aCA+IDApLmxlbmd0aDsKCiAgY29uc3QgZm9ybWF0ID0gKHZhbCkgPT4gKHZhbCB8fCAwKS50b0xvY2FsZVN0cmluZygpOwoKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhdC1ydWxlcycpLnRleHRDb250ZW50ID0gZm9ybWF0KHJ1bGVzLmxlbmd0aCk7CgogIC8vIENvbnN0cmFpbnQtc3BlY2lmaWMgY291bnRzCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXQtbm8tb2JmdXNjYXRpb24tY2xhc3NlcycpLnRleHRDb250ZW50ID0gZm9ybWF0KGNvbnN0cmFpbnRTdGF0cy5ET05UX09CRlVTQ0FURS5jbGFzc2VzLnNpemUpOwogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGF0LW5vLW9iZnVzY2F0aW9uLW1ldGhvZHMnKS50ZXh0Q29udGVudCA9IGZvcm1hdChjb25zdHJhaW50U3RhdHMuRE9OVF9PQkZVU0NBVEUubWV0aG9kcy5zaXplKTsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhdC1uby1vYmZ1c2NhdGlvbi1maWVsZHMnKS50ZXh0Q29udGVudCA9IGZvcm1hdChjb25zdHJhaW50U3RhdHMuRE9OVF9PQkZVU0NBVEUuZmllbGRzLnNpemUpOwoKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhdC1uby1vcHRpbWl6YXRpb24tY2xhc3NlcycpLnRleHRDb250ZW50ID0gZm9ybWF0KGNvbnN0cmFpbnRTdGF0cy5ET05UX09QVElNSVpFLmNsYXNzZXMuc2l6ZSk7CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXQtbm8tb3B0aW1pemF0aW9uLW1ldGhvZHMnKS50ZXh0Q29udGVudCA9IGZvcm1hdChjb25zdHJhaW50U3RhdHMuRE9OVF9PUFRJTUlaRS5tZXRob2RzLnNpemUpOwogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGF0LW5vLW9wdGltaXphdGlvbi1maWVsZHMnKS50ZXh0Q29udGVudCA9IGZvcm1hdChjb25zdHJhaW50U3RhdHMuRE9OVF9PUFRJTUlaRS5maWVsZHMuc2l6ZSk7CgogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGF0LW5vLXNocmlua2luZy1jbGFzc2VzJykudGV4dENvbnRlbnQgPSBmb3JtYXQoY29uc3RyYWludFN0YXRzLkRPTlRfU0hSSU5LLmNsYXNzZXMuc2l6ZSk7CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXQtbm8tc2hyaW5raW5nLW1ldGhvZHMnKS50ZXh0Q29udGVudCA9IGZvcm1hdChjb25zdHJhaW50U3RhdHMuRE9OVF9TSFJJTksubWV0aG9kcy5zaXplKTsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhdC1uby1zaHJpbmtpbmctZmllbGRzJykudGV4dENvbnRlbnQgPSBmb3JtYXQoY29uc3RyYWludFN0YXRzLkRPTlRfU0hSSU5LLmZpZWxkcy5zaXplKTsKCiAgaWYgKGNvbnRhaW5lckRhdGEuYnVpbGRJbmZvKSB7CiAgICBjb25zdCBpbmZvID0gY29udGFpbmVyRGF0YS5idWlsZEluZm87CiAgICAvLyBSZWFjaGFibGUgY291bnRzCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhdC1yZWFjaGFibGUtY2xhc3NlcycpLnRleHRDb250ZW50ID0gZm9ybWF0KGluZm8ubGl2ZUNsYXNzQ291bnQpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXQtcmVhY2hhYmxlLW1ldGhvZHMnKS50ZXh0Q29udGVudCA9IGZvcm1hdChpbmZvLmxpdmVNZXRob2RDb3VudCk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhdC1yZWFjaGFibGUtZmllbGRzJykudGV4dENvbnRlbnQgPSBmb3JtYXQoaW5mby5saXZlRmllbGRDb3VudCk7CiAgICAvLyBUb3RhbCBjb3VudHMKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGF0LXRvdGFsLWNsYXNzZXMnKS50ZXh0Q29udGVudCA9IGZvcm1hdChpbmZvLmNsYXNzQ291bnQpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXQtdG90YWwtbWV0aG9kcycpLnRleHRDb250ZW50ID0gZm9ybWF0KGluZm8ubWV0aG9kQ291bnQpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXQtdG90YWwtZmllbGRzJykudGV4dENvbnRlbnQgPSBmb3JtYXQoaW5mby5maWVsZENvdW50KTsKICB9IGVsc2UgewogICAgLy8gRmFsbGJhY2sgaWYgYnVpbGRJbmZvIGlzIG1pc3NpbmcKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGF0LXJlYWNoYWJsZS1jbGFzc2VzJykudGV4dENvbnRlbnQgPSAiLSI7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhdC1yZWFjaGFibGUtbWV0aG9kcycpLnRleHRDb250ZW50ID0gIi0iOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXQtcmVhY2hhYmxlLWZpZWxkcycpLnRleHRDb250ZW50ID0gIi0iOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXQtdG90YWwtY2xhc3NlcycpLnRleHRDb250ZW50ID0gIi0iOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXQtdG90YWwtbWV0aG9kcycpLnRleHRDb250ZW50ID0gIi0iOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXQtdG90YWwtZmllbGRzJykudGV4dENvbnRlbnQgPSAiLSI7CiAgfQoKICBjb25zdCB1bnVzZWRCYWRnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1bnVzZWQtY291bnQnKTsKICB1bnVzZWRCYWRnZS50ZXh0Q29udGVudCA9IHVudXNlZENvdW50OwogIHVudXNlZEJhZGdlLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOwoKICBjb25zdCByZWR1bmRhbnRCYWRnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWR1bmRhbnQtY291bnQnKTsKICByZWR1bmRhbnRCYWRnZS50ZXh0Q29udGVudCA9IHJlZHVuZGFudENvdW50OwogIHJlZHVuZGFudEJhZGdlLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOwoKICBjb25zdCBydWxlc0JhZGdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3J1bGVzLWNvdW50Jyk7CiAgcnVsZXNCYWRnZS50ZXh0Q29udGVudCA9IHJ1bGVzLmxlbmd0aDsKICBydWxlc0JhZGdlLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOwoKICBjb25zdCBmaWxlc0JhZGdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVzLWNvdW50Jyk7CiAgZmlsZXNCYWRnZS50ZXh0Q29udGVudCA9IHRhYmxlcy5maWxlcy5zaXplOwogIGZpbGVzQmFkZ2UuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7Cn0KCmZ1bmN0aW9uIGZpbHRlclJ1bGVzKHF1ZXJ5KSB7CiAgY29uc3QgcnVsZXMgPSBjb250YWluZXJEYXRhLmtlZXBSdWxlQmxhc3RSYWRpdXNUYWJsZSB8fCBbXTsKICBjb25zdCBsb3dlclF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKTsKCiAgZmlsdGVyZWRSdWxlcyA9IHJ1bGVzLmZpbHRlcihyID0+CiAgICByLnNvdXJjZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyUXVlcnkpCiAgKTsKCiAgZmlsdGVyZWRSdWxlcy5zb3J0KChhLCBiKSA9PiBiLnRvdGFsUmFkaXVzIC0gYS50b3RhbFJhZGl1cyk7CiAgcmVuZGVyUnVsZUxpc3QoKTsKfQoKZnVuY3Rpb24gZmlsdGVyRmlsZXMocXVlcnkpIHsKICBjb25zdCBmaWxlcyA9IEFycmF5LmZyb20odGFibGVzLmZpbGVzLnZhbHVlcygpKTsKICBjb25zdCBsb3dlclF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKTsKCiAgZmlsdGVyZWRGaWxlcyA9IGZpbGVzLmZpbHRlcihmID0+CiAgICBmLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhsb3dlclF1ZXJ5KQogICk7CgogIGZpbHRlcmVkRmlsZXMuc29ydCgoYSwgYikgPT4gYi50b3RhbFJhZGl1cyAtIGEudG90YWxSYWRpdXMpOwogIHJlbmRlckZpbGVMaXN0KCk7Cn0KCmZ1bmN0aW9uIHJlbmRlclJ1bGVMaXN0KCkgewogIHJ1bGVMaXN0LmlubmVySFRNTCA9ICcnOwogIGZpbHRlcmVkUnVsZXMuZm9yRWFjaChydWxlID0+IHsKICAgIGNvbnN0IGlzUmVkdW5kYW50ID0gcnVsZS5ibGFzdFJhZGl1cy5zdWJzdW1lZEJ5ICYmIHJ1bGUuYmxhc3RSYWRpdXMuc3Vic3VtZWRCeS5sZW5ndGggPiAwOwogICAgbGV0IHNhbWVPcmlnaW5TdWJzdW1wdGlvbiA9IGZhbHNlOwogICAgaWYgKGlzUmVkdW5kYW50KSB7CiAgICAgIGNvbnN0IHJ1bGVPcmlnaW5GaWxlID0gZ2V0RmlsZU5hbWUocnVsZS5vcmlnaW4pOwogICAgICBzYW1lT3JpZ2luU3Vic3VtcHRpb24gPSBydWxlLmJsYXN0UmFkaXVzLnN1YnN1bWVkQnkuc29tZShpZCA9PiB7CiAgICAgICAgY29uc3Qgc3Vic3VtZXIgPSB0YWJsZXMucnVsZXMuZ2V0KGlkKTsKICAgICAgICByZXR1cm4gc3Vic3VtZXIgJiYgZ2V0RmlsZU5hbWUoc3Vic3VtZXIub3JpZ2luKSA9PT0gcnVsZU9yaWdpbkZpbGU7CiAgICAgIH0pOwogICAgfQoKICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgZGl2LmNsYXNzTmFtZSA9ICdydWxlLWl0ZW0nOwogICAgZGl2LmRhdGFzZXQucnVsZUlkID0gcnVsZS5pZDsKICAgIGNvbnN0IGNsYXNzZXMgPSBydWxlLmJsYXN0UmFkaXVzLmNsYXNzQmxhc3RSYWRpdXM/Lmxlbmd0aCB8fCAwOwogICAgY29uc3QgbWV0aG9kcyA9IHJ1bGUuYmxhc3RSYWRpdXMubWV0aG9kQmxhc3RSYWRpdXM/Lmxlbmd0aCB8fCAwOwogICAgY29uc3QgZmllbGRzID0gcnVsZS5ibGFzdFJhZGl1cy5maWVsZEJsYXN0UmFkaXVzPy5sZW5ndGggfHwgMDsKICAgIGRpdi5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0OyBnYXA6IDhweDsiPgogICAgICAgICAgICAgICAgJHtzYW1lT3JpZ2luU3Vic3VtcHRpb24gPyAnPHNwYW4gdGl0bGU9IlN1YnN1bWVkIGJ5IHJ1bGUgaW4gc2FtZSBmaWxlIiBzdHlsZT0iY29sb3I6ICNmZjk4MDA7IGN1cnNvcjogaGVscDsiPuKaoO+4jzwvc3Bhbj4nIDogJyd9CiAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJmbGV4OiAxOyI+CiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InJ1bGUtbmFtZSI+JHtlc2NhcGVIdG1sKHJ1bGUuc291cmNlKX08L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgJHtjdXJyZW50VmlldyAhPT0gInVudXNlZCIgPyBgCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJ1bGUtc3RhdHMiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgQmxhc3QgcmFkaXVzOiAke3J1bGUudG90YWxSYWRpdXN9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2Zvcm1hdFN0YXRzQnJlYWtkb3duKGNsYXNzZXMsIG1ldGhvZHMsIGZpZWxkcyl9CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIGAgOiAnJ30KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICBgOwogICAgZGl2Lm9uY2xpY2sgPSAoKSA9PiBzZWxlY3RSdWxlKHJ1bGUsIGRpdik7CiAgICBydWxlTGlzdC5hcHBlbmRDaGlsZChkaXYpOwogIH0pOwp9CgpmdW5jdGlvbiByZW5kZXJGaWxlTGlzdCgpIHsKICBydWxlTGlzdC5pbm5lckhUTUwgPSAnJzsKICBmaWx0ZXJlZEZpbGVzLmZvckVhY2goZmlsZSA9PiB7CiAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgIGRpdi5jbGFzc05hbWUgPSAncnVsZS1pdGVtJzsKICAgIGRpdi5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJydWxlLW5hbWUiPiR7ZXNjYXBlSHRtbChnZXRPcmlnaW5TdHJpbmcoZmlsZS5vcmlnaW4pKX08L3NwYW4+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InJ1bGUtc3RhdHMiPgogICAgICAgICAgICAgICAgQmxhc3QgcmFkaXVzOiAke2ZpbGUudG90YWxSYWRpdXN9IGFjcm9zcyAke2ZpbGUucnVsZXMubGVuZ3RofSBydWxlcwogICAgICAgICAgICAgICAgPGJyPiR7Zm9ybWF0U3RhdHNCcmVha2Rvd24oZmlsZS5jbGFzc2VzLCBmaWxlLm1ldGhvZHMsIGZpbGUuZmllbGRzKX0KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgYDsKICAgIGRpdi5vbmNsaWNrID0gKCkgPT4gc2VsZWN0RmlsZShmaWxlLCBkaXYpOwogICAgcnVsZUxpc3QuYXBwZW5kQ2hpbGQoZGl2KTsKICB9KTsKfQoKZnVuY3Rpb24gc2VsZWN0UnVsZShydWxlLCBlbGVtZW50KSB7CiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnJ1bGUtaXRlbScpLmZvckVhY2goZWwgPT4gZWwuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpOwogIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgY3VycmVudFNlbGVjdGVkUnVsZSA9IHJ1bGU7CiAgY3VycmVudFN1YlZpZXcgPSAnY2xhc3MnOwogIGN1cnJlbnRSdWxlUGFnaW5hdGlvbiA9IHsKICAgIGNsYXNzZXM6IDEwMCwKICAgIG1ldGhvZHM6IDEwMCwKICAgIGZpZWxkczogMTAwCiAgfTsKICByZW5kZXJSdWxlRGV0YWlsKHJ1bGUpOwp9CgpmdW5jdGlvbiBzZWxlY3RGaWxlKGZpbGUsIGVsZW1lbnQpIHsKICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucnVsZS1pdGVtJykuZm9yRWFjaChlbCA9PiBlbC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSk7CiAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICByZW5kZXJGaWxlRGV0YWlsKGZpbGUpOwp9CgpmdW5jdGlvbiByZW5kZXJSdWxlRGV0YWlsKHJ1bGUpIHsKICBjb25zdCBpc1JlZHVuZGFudCA9IHJ1bGUuYmxhc3RSYWRpdXMuc3Vic3VtZWRCeSAmJiBydWxlLmJsYXN0UmFkaXVzLnN1YnN1bWVkQnkubGVuZ3RoID4gMDsKICBjb25zdCBydWxlT3JpZ2luRmlsZSA9IGdldEZpbGVOYW1lKHJ1bGUub3JpZ2luKTsKCiAgbGV0IGh0bWwgPSBgCiAgICAgICAgPGRpdiBjbGFzcz0iY2FyZCI+CiAgICAgICAgICAgIDxoMj5LZWVwIFJ1bGUgRGV0YWlsczwvaDI+CiAgICAgICAgICAgICR7aXNSZWR1bmRhbnQgPyBydWxlLmJsYXN0UmFkaXVzLnN1YnN1bWVkQnkubWFwKGlkID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB0YWJsZXMucnVsZXMuZ2V0KGlkKTsKICAgICAgICAgICAgICAgIGNvbnN0IGlzU2FtZUZpbGUgPSByICYmIGdldEZpbGVOYW1lKHIub3JpZ2luKSA9PT0gcnVsZU9yaWdpbkZpbGU7CiAgICAgICAgICAgICAgICBjb25zdCBvcmlnaW5TdHIgPSByID8gZ2V0T3JpZ2luU3RyaW5nKHIub3JpZ2luKSA6ICJVbmtub3duIG9yaWdpbiI7CiAgICAgICAgICAgICAgICByZXR1cm4gYAogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImJhbm5lciBiYW5uZXItd2FybmluZyI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJvbmc+UmVkdW5kYW50IFJ1bGU6PC9zdHJvbmc+IFRoaXMgcnVsZSBpcyBmdWxseSBzdWJzdW1lZCBieSAke2lzU2FtZUZpbGUgPyAnYW5vdGhlciBydWxlIGluIHRoZSBzYW1lIGZpbGUnIDogJ2EgcnVsZSBpbiBhIGRpZmZlcmVudCBmaWxlJ306CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi10b3A6IDAuNXJlbTsiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3Vic3VtZWQtYnktaXRlbSIgb25jbGljaz0ibmF2aWdhdGVUb1J1bGUoJyR7aWR9JykiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtd2VpZ2h0OiA1MDA7Ij4ke3IgPyBlc2NhcGVIdG1sKHIuc291cmNlKSA6IGBSdWxlIElEOiAke2lkfWB9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iZm9udC1zaXplOiAwLjhyZW07IGNvbG9yOiAjNjY2OyBtYXJnaW4tdG9wOiAycHg7Ij5PcmlnaW46ICR7ZXNjYXBlSHRtbChvcmlnaW5TdHIpfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgYDsKICAgICAgICAgICAgfSkuam9pbignJykgOiAnJ30KICAgICAgICAgICAgPGRpdiBjbGFzcz0ia2VlcC1ydWxlLXNvdXJjZSI+JHtlc2NhcGVIdG1sKHJ1bGUuc291cmNlKX08L2Rpdj4KICAgICAgICAgICAgPHA+PHN0cm9uZz5PcmlnaW46PC9zdHJvbmc+ICR7ZXNjYXBlSHRtbChnZXRPcmlnaW5TdHJpbmcocnVsZS5vcmlnaW4pKX08L3A+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0ic3ViLXRhYnMiPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJzdWItdGFiLWJ1dHRvbiAke2N1cnJlbnRTdWJWaWV3ID09PSAnY2xhc3MnID8gJ2FjdGl2ZScgOiAnJ30iIG9uY2xpY2s9InN3aXRjaFN1YlZpZXcoJ2NsYXNzJykiPgogICAgICAgICAgICAgICAgTWF0Y2hlZCBDbGFzc2VzIDxzcGFuIGNsYXNzPSJiYWRnZSI+JHtydWxlLmJsYXN0UmFkaXVzLmNsYXNzQmxhc3RSYWRpdXM/Lmxlbmd0aCB8fCAwfTwvc3Bhbj4KICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9InN1Yi10YWItYnV0dG9uICR7Y3VycmVudFN1YlZpZXcgPT09ICdtZXRob2QnID8gJ2FjdGl2ZScgOiAnJ30iIG9uY2xpY2s9InN3aXRjaFN1YlZpZXcoJ21ldGhvZCcpIj4KICAgICAgICAgICAgICAgIE1hdGNoZWQgTWV0aG9kcyA8c3BhbiBjbGFzcz0iYmFkZ2UiPiR7cnVsZS5ibGFzdFJhZGl1cy5tZXRob2RCbGFzdFJhZGl1cz8ubGVuZ3RoIHx8IDB9PC9zcGFuPgogICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ic3ViLXRhYi1idXR0b24gJHtjdXJyZW50U3ViVmlldyA9PT0gJ2ZpZWxkJyA/ICdhY3RpdmUnIDogJyd9IiBvbmNsaWNrPSJzd2l0Y2hTdWJWaWV3KCdmaWVsZCcpIj4KICAgICAgICAgICAgICAgIE1hdGNoZWQgRmllbGRzIDxzcGFuIGNsYXNzPSJiYWRnZSI+JHtydWxlLmJsYXN0UmFkaXVzLmZpZWxkQmxhc3RSYWRpdXM/Lmxlbmd0aCB8fCAwfTwvc3Bhbj4KICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgPC9kaXY+CiAgICBgOwoKICBodG1sICs9IHJlbmRlckJsYXN0UmFkaXVzSXRlbXMocnVsZS5ibGFzdFJhZGl1cyk7CiAgbWFpbkNvbnRlbnQuaW5uZXJIVE1MID0gaHRtbDsKfQoKZnVuY3Rpb24gcmVuZGVyRmlsZURldGFpbChmaWxlKSB7CiAgY29uc3QgdXNlZFJ1bGVzID0gZmlsZS5ydWxlcy5maWx0ZXIociA9PiByLnRvdGFsUmFkaXVzID4gMCkuc29ydCgoYSwgYikgPT4gYi50b3RhbFJhZGl1cyAtIGEudG90YWxSYWRpdXMpOwogIGNvbnN0IHVudXNlZFJ1bGVzID0gZmlsZS5ydWxlcy5maWx0ZXIociA9PiByLnRvdGFsUmFkaXVzID09PSAwKS5zb3J0KChhLCBiKSA9PiBhLnNvdXJjZS5sb2NhbGVDb21wYXJlKGIuc291cmNlKSk7CgogIGxldCBodG1sID0gYAogICAgICAgIDxkaXYgY2xhc3M9ImNhcmQiPgogICAgICAgICAgICA8aDI+RmlsZSBEZXRhaWxzPC9oMj4KICAgICAgICAgICAgPHA+PHN0cm9uZz5GaWxlOjwvc3Ryb25nPiAke2VzY2FwZUh0bWwoZmlsZS5uYW1lKX08L3A+CiAgICAgICAgICAgIDxwPjxzdHJvbmc+Qmxhc3QgcmFkaXVzOjwvc3Ryb25nPiAke2ZpbGUudG90YWxSYWRpdXN9IGl0ZW1zIGtlcHQgYWNyb3NzICR7ZmlsZS5ydWxlcy5sZW5ndGh9IHJ1bGVzLjwvcD4KICAgICAgICA8L2Rpdj4KICAgIGA7CgogIGlmICh1c2VkUnVsZXMubGVuZ3RoID4gMCkgewogICAgaHRtbCArPSBgCiAgICAgICAgPGRpdiBjbGFzcz0iY2FyZCI+CiAgICAgICAgICAgIDxoMj5LZWVwIFJ1bGVzIGluIHRoaXMgRmlsZTwvaDI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9Iml0ZW0tbGlzdCI+CiAgICAgICAgICAgICAgICAke3VzZWRSdWxlcy5tYXAociA9PiBgCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icnVsZS1pdGVtIiBvbmNsaWNrPSJuYXZpZ2F0ZVRvUnVsZSgnJHtyLmlkfScpIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icnVsZS1uYW1lIj4ke2VzY2FwZUh0bWwoci5zb3VyY2UpfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJydWxlLXN0YXRzIj5CbGFzdCByYWRpdXM6ICR7ci50b3RhbFJhZGl1c308L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIGApLmpvaW4oJycpfQogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgIGA7CiAgfQoKICBpZiAodW51c2VkUnVsZXMubGVuZ3RoID4gMCkgewogICAgaHRtbCArPSBgCiAgICAgICAgPGRpdiBjbGFzcz0iY2FyZCI+CiAgICAgICAgICAgIDxoMj5VbnVzZWQgS2VlcCBSdWxlcyBpbiB0aGlzIEZpbGU8L2gyPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJpdGVtLWxpc3QiPgogICAgICAgICAgICAgICAgJHt1bnVzZWRSdWxlcy5tYXAociA9PiBgCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icnVsZS1pdGVtIiBvbmNsaWNrPSJuYXZpZ2F0ZVRvUnVsZSgnJHtyLmlkfScpIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icnVsZS1uYW1lIj4ke2VzY2FwZUh0bWwoci5zb3VyY2UpfTwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgYCkuam9pbignJyl9CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgogICAgYDsKICB9CgogIG1haW5Db250ZW50LmlubmVySFRNTCA9IGh0bWw7Cn0KCmZ1bmN0aW9uIHJlbmRlckJsYXN0UmFkaXVzSXRlbXMoYmxhc3RSYWRpdXMpIHsKICBsZXQgaHRtbCA9ICIiOwoKICBjb25zdCByZW5kZXJTZWN0aW9uID0gKHRpdGxlLCBpdGVtcywgdHlwZSwgZm9ybWF0dGVyLCBiYWRnZUNsYXNzLCBsaW1pdCkgPT4gewogICAgaWYgKGN1cnJlbnRTdWJWaWV3ICE9PSB0eXBlKSByZXR1cm4gIiI7CiAgICBpZiAoIWl0ZW1zIHx8IGl0ZW1zLmxlbmd0aCA9PT0gMCkgewogICAgICByZXR1cm4gYAogICAgICAgIDxkaXYgY2xhc3M9ImNhcmQiPgogICAgICAgICAgICA8cCBzdHlsZT0iY29sb3I6ICM2NjY7IGZvbnQtc3R5bGU6IGl0YWxpYzsiPk5vIGl0ZW1zIG1hdGNoZWQgdGhpcyBjYXRlZ29yeS48L3A+CiAgICAgICAgPC9kaXY+CiAgICAgIGA7CiAgICB9CiAgICBjb25zdCB2aXNpYmxlSXRlbXMgPSBpdGVtcy5zbGljZSgwLCBsaW1pdCk7CiAgICBjb25zdCBoYXNNb3JlID0gaXRlbXMubGVuZ3RoID4gbGltaXQ7CgogICAgcmV0dXJuIGAKICAgICAgICAgICAgPGRpdiBjbGFzcz0iY2FyZCI+CiAgICAgICAgICAgICAgICA8dWwgY2xhc3M9Iml0ZW0tbGlzdCI+CiAgICAgICAgICAgICAgICAgICAgJHt2aXNpYmxlSXRlbXMubWFwKGlkID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5mbyA9IHR5cGUgPT09ICdjbGFzcycgPyB0YWJsZXMuY2xhc3Nlcy5nZXQoaWQpIDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodHlwZSA9PT0gJ21ldGhvZCcgPyB0YWJsZXMubWV0aG9kcy5nZXQoaWQpIDogdGFibGVzLmZpZWxkcy5nZXQoaWQpKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGluZm8gPyBgPGxpPiR7ZXNjYXBlSHRtbChmb3JtYXR0ZXIodHlwZSA9PT0gJ2NsYXNzJyA/IGluZm8uY2xhc3NSZWZlcmVuY2VJZCA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHR5cGUgPT09ICdtZXRob2QnID8gaW5mby5tZXRob2RSZWZlcmVuY2VJZCA6IGluZm8uZmllbGRSZWZlcmVuY2VJZCkpKX08L2xpPmAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBgPGxpPlVua25vd24gJHt0eXBlfSBJRCAke2lkfTwvbGk+YDsKICAgICAgICAgICAgICAgICAgICB9KS5qb2luKCcnKX0KICAgICAgICAgICAgICAgIDwvdWw+CiAgICAgICAgICAgICAgICAke2hhc01vcmUgPyBgPGJ1dHRvbiBjbGFzcz0ic2hvdy1tb3JlLWJ0biIgb25jbGljaz0ic2hvd01vcmUoJyR7dHlwZX0nKSI+U2hvdyBtb3JlICgke2l0ZW1zLmxlbmd0aCAtIGxpbWl0fSByZW1haW5pbmcpPC9idXR0b24+YCA6ICcnfQogICAgICAgICAgICA8L2Rpdj4KICAgICAgICBgOwogIH07CgogIGh0bWwgKz0gcmVuZGVyU2VjdGlvbigiTWF0Y2hlZCBDbGFzc2VzIiwgYmxhc3RSYWRpdXMuY2xhc3NCbGFzdFJhZGl1cywgJ2NsYXNzJywgZm9ybWF0VHlwZU5hbWUsICdiYWRnZS1ncmVlbicsIGN1cnJlbnRSdWxlUGFnaW5hdGlvbi5jbGFzc2VzKTsKICBodG1sICs9IHJlbmRlclNlY3Rpb24oIk1hdGNoZWQgTWV0aG9kcyIsIGJsYXN0UmFkaXVzLm1ldGhvZEJsYXN0UmFkaXVzLCAnbWV0aG9kJywgZm9ybWF0TWV0aG9kTmFtZSwgJ2JhZGdlLWJsdWUnLCBjdXJyZW50UnVsZVBhZ2luYXRpb24ubWV0aG9kcyk7CiAgaHRtbCArPSByZW5kZXJTZWN0aW9uKCJNYXRjaGVkIEZpZWxkcyIsIGJsYXN0UmFkaXVzLmZpZWxkQmxhc3RSYWRpdXMsICdmaWVsZCcsIGZvcm1hdEZpZWxkTmFtZSwgJ2JhZGdlLXJlZCcsIGN1cnJlbnRSdWxlUGFnaW5hdGlvbi5maWVsZHMpOwoKICByZXR1cm4gaHRtbDsKfQoKZnVuY3Rpb24gc2hvd01vcmUodHlwZSkgewogIGlmICh0eXBlID09PSAnY2xhc3MnKSBjdXJyZW50UnVsZVBhZ2luYXRpb24uY2xhc3NlcyArPSAxMDA7CiAgZWxzZSBpZiAodHlwZSA9PT0gJ21ldGhvZCcpIGN1cnJlbnRSdWxlUGFnaW5hdGlvbi5tZXRob2RzICs9IDEwMDsKICBlbHNlIGlmICh0eXBlID09PSAnZmllbGQnKSBjdXJyZW50UnVsZVBhZ2luYXRpb24uZmllbGRzICs9IDEwMDsKCiAgaWYgKGN1cnJlbnRTZWxlY3RlZFJ1bGUpIHsKICAgIHJlbmRlclJ1bGVEZXRhaWwoY3VycmVudFNlbGVjdGVkUnVsZSk7CiAgfQp9CgpmdW5jdGlvbiBmaWx0ZXJVbnVzZWRSdWxlcyhxdWVyeSkgewogIGNvbnN0IHJ1bGVzID0gY29udGFpbmVyRGF0YS5rZWVwUnVsZUJsYXN0UmFkaXVzVGFibGUgfHwgW107CiAgY29uc3QgbG93ZXJRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7CgogIGZpbHRlcmVkUnVsZXMgPSBydWxlcy5maWx0ZXIociA9PgogICAgci50b3RhbFJhZGl1cyA9PT0gMCAmJiByLnNvdXJjZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyUXVlcnkpCiAgKTsKCiAgLy8gRm9yIHVudXNlZCBydWxlcywgc29ydCBieSBzb3VyY2UgdGV4dAogIGZpbHRlcmVkUnVsZXMuc29ydCgoYSwgYikgPT4gYS5zb3VyY2UubG9jYWxlQ29tcGFyZShiLnNvdXJjZSkpOwogIHJlbmRlclJ1bGVMaXN0KCk7Cn0KCmZ1bmN0aW9uIGZpbHRlclJlZHVuZGFudFJ1bGVzKHF1ZXJ5KSB7CiAgY29uc3QgcnVsZXMgPSBjb250YWluZXJEYXRhLmtlZXBSdWxlQmxhc3RSYWRpdXNUYWJsZSB8fCBbXTsKICBjb25zdCBsb3dlclF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKTsKCiAgZmlsdGVyZWRSdWxlcyA9IHJ1bGVzLmZpbHRlcihyID0+CiAgICByLmJsYXN0UmFkaXVzLnN1YnN1bWVkQnkgJiYgci5ibGFzdFJhZGl1cy5zdWJzdW1lZEJ5Lmxlbmd0aCA+IDAgJiYKICAgIHIuc291cmNlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobG93ZXJRdWVyeSkKICApOwoKICBmaWx0ZXJlZFJ1bGVzLnNvcnQoKGEsIGIpID0+IGIudG90YWxSYWRpdXMgLSBhLnRvdGFsUmFkaXVzKTsKICByZW5kZXJSdWxlTGlzdCgpOwp9CgpmdW5jdGlvbiBuYXZpZ2F0ZVRvUnVsZShydWxlSWQpIHsKICBjb25zdCBydWxlID0gdGFibGVzLnJ1bGVzLmdldChOdW1iZXIocnVsZUlkKSk7CiAgaWYgKCFydWxlKSByZXR1cm47CgogIHN3aXRjaFZpZXcoJ3J1bGVzJywgdHJ1ZSk7CiAgY29uc3QgZWxlbWVudCA9IHJ1bGVMaXN0LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXJ1bGUtaWQ9IiR7cnVsZS5pZH0iXWApOwogIGlmIChlbGVtZW50KSB7CiAgICBzZWxlY3RSdWxlKHJ1bGUsIGVsZW1lbnQpOwogICAgZWxlbWVudC5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICduZWFyZXN0JyB9KTsKICB9Cn0KCmZ1bmN0aW9uIHN3aXRjaFZpZXcodmlldywgcHJlc2VydmVEZXRhaWwgPSBmYWxzZSkgewogIGN1cnJlbnRWaWV3ID0gdmlldzsKICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFiLWJ1dHRvbicpLmZvckVhY2goYnRuID0+IHsKICAgIGJ0bi5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCBidG4uZ2V0QXR0cmlidXRlKCdvbmNsaWNrJykuaW5jbHVkZXMoYCcke3ZpZXd9J2ApKTsKICB9KTsKCiAgc2VhcmNoSW5wdXQudmFsdWUgPSAiIjsKICBzZWFyY2hJbnB1dC5wbGFjZWhvbGRlciA9IHZpZXcgPT09ICdmaWxlcycgPyAiU2VhcmNoIGZpbGVzLi4uIiA6ICJTZWFyY2gga2VlcCBydWxlcy4uLiI7CgogIGlmIChjb250YWluZXJEYXRhKSB7CiAgICBpZiAodmlldyA9PT0gJ3J1bGVzJykgewogICAgICBmaWx0ZXJSdWxlcygiIik7CiAgICAgIGlmICghcHJlc2VydmVEZXRhaWwpIHsKICAgICAgICByZW5kZXJTdGF0c092ZXJ2aWV3KCk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodmlldyA9PT0gJ3VudXNlZCcpIHsKICAgICAgZmlsdGVyVW51c2VkUnVsZXMoIiIpOwogICAgICBtYWluQ29udGVudC5pbm5lckhUTUwgPSAnJzsKICAgIH0gZWxzZSBpZiAodmlldyA9PT0gJ3JlZHVuZGFudCcpIHsKICAgICAgZmlsdGVyUmVkdW5kYW50UnVsZXMoIiIpOwogICAgICBtYWluQ29udGVudC5pbm5lckhUTUwgPSAnJzsKICAgIH0gZWxzZSBpZiAodmlldyA9PT0gJ2ZpbGVzJykgewogICAgICBmaWx0ZXJGaWxlcygiIik7CiAgICAgIG1haW5Db250ZW50LmlubmVySFRNTCA9ICcnOwogICAgfQogIH0gZWxzZSB7CiAgICByZW5kZXJXZWxjb21lTWVzc2FnZSgpOwogIH0KfQoKZnVuY3Rpb24gc3dpdGNoU3ViVmlldyhzdWJWaWV3KSB7CiAgY3VycmVudFN1YlZpZXcgPSBzdWJWaWV3OwogIGlmIChjdXJyZW50U2VsZWN0ZWRSdWxlKSB7CiAgICByZW5kZXJSdWxlRGV0YWlsKGN1cnJlbnRTZWxlY3RlZFJ1bGUpOwogIH0KfQoKZnVuY3Rpb24gcmVuZGVyU3RhdHNPdmVydmlldygpIHsKICBjb25zdCB0ZW1wbGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGF0cy1vdmVydmlldy10ZW1wbGF0ZScpOwogIG1haW5Db250ZW50LmlubmVySFRNTCA9ICcnOwogIG1haW5Db250ZW50LmFwcGVuZENoaWxkKHRlbXBsYXRlLmNvbnRlbnQuY2xvbmVOb2RlKHRydWUpKTsKICByZW5kZXJTdGF0cygpOwp9CgpmdW5jdGlvbiByZW5kZXJXZWxjb21lTWVzc2FnZSgpIHsKICBjb25zdCB0ZW1wbGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3ZWxjb21lLW1lc3NhZ2UtdGVtcGxhdGUnKTsKICBpZiAodGVtcGxhdGUpIHsKICAgIG1haW5Db250ZW50LmlubmVySFRNTCA9ICcnOwogICAgbWFpbkNvbnRlbnQuYXBwZW5kQ2hpbGQodGVtcGxhdGUuY29udGVudC5jbG9uZU5vZGUodHJ1ZSkpOwogIH0KfQoKZnVuY3Rpb24gcmVuZGVyTG9hZGluZygpIHsKICBtYWluQ29udGVudC5pbm5lckhUTUwgPSBgCiAgICA8ZGl2IGlkPSJsb2FkaW5nLXNjcmVlbiI+CiAgICAgIDxkaXYgY2xhc3M9InNwaW5uZXIiPjwvZGl2PgogICAgICA8cD5Qcm9jZXNzaW5nIGRhdGEuLi48L3A+CiAgICA8L2Rpdj4KICBgOwp9CgpmdW5jdGlvbiBmb3JtYXRUeXBlTmFtZSh0eXBlSWQpIHsKICBjb25zdCB0eXBlID0gdGFibGVzLnR5cGVzLmdldCh0eXBlSWQpOwogIGlmICghdHlwZSkgcmV0dXJuICJVbmtub3duIjsKICByZXR1cm4gZm9ybWF0RGVzY3JpcHRvcih0eXBlLmphdmFEZXNjcmlwdG9yKTsKfQoKZnVuY3Rpb24gZm9ybWF0RGVzY3JpcHRvcihkZXNjKSB7CiAgaWYgKCFkZXNjKSByZXR1cm4gIiI7CiAgbGV0IGRpbWVuc2lvbnMgPSAwOwogIHdoaWxlIChkZXNjW2RpbWVuc2lvbnNdID09PSAnWycpIHsKICAgIGRpbWVuc2lvbnMrKzsKICB9CiAgbGV0IGJhc2UgPSBkZXNjLnN1YnN0cmluZyhkaW1lbnNpb25zKTsKICBsZXQgcmVzID0gIiI7CiAgaWYgKGJhc2Uuc3RhcnRzV2l0aCgnTCcpICYmIGJhc2UuZW5kc1dpdGgoJzsnKSkgewogICAgcmVzID0gYmFzZS5zdWJzdHJpbmcoMSwgYmFzZS5sZW5ndGggLSAxKS5yZXBsYWNlKC9cLy9nLCAnLicpOwogIH0gZWxzZSBpZiAoYmFzZS5sZW5ndGggPT09IDEpIHsKICAgIHN3aXRjaCAoYmFzZVswXSkgewogICAgICBjYXNlICdWJzoKICAgICAgICByZXMgPSAidm9pZCI7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ1onOgogICAgICAgIHJlcyA9ICJib29sZWFuIjsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnQic6CiAgICAgICAgcmVzID0gImJ5dGUiOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdTJzoKICAgICAgICByZXMgPSAic2hvcnQiOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdDJzoKICAgICAgICByZXMgPSAiY2hhciI7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0knOgogICAgICAgIHJlcyA9ICJpbnQiOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdKJzoKICAgICAgICByZXMgPSAibG9uZyI7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0YnOgogICAgICAgIHJlcyA9ICJmbG9hdCI7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0QnOgogICAgICAgIHJlcyA9ICJkb3VibGUiOwogICAgICAgIGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgIHJlcyA9IGJhc2U7CiAgICB9CiAgfSBlbHNlIHsKICAgIHJlcyA9IGJhc2U7CiAgfQogIGZvciAobGV0IGkgPSAwOyBpIDwgZGltZW5zaW9uczsgaSsrKSB7CiAgICByZXMgKz0gIltdIjsKICB9CiAgcmV0dXJuIHJlczsKfQoKZnVuY3Rpb24gZm9ybWF0TWV0aG9kTmFtZShtZXRob2RSZWZJZCkgewogIGNvbnN0IHJlZiA9IHRhYmxlcy5tZXRob2RSZWZzLmdldChtZXRob2RSZWZJZCk7CiAgaWYgKCFyZWYpIHJldHVybiAiVW5rbm93biBtZXRob2QiOwogIGNvbnN0IGNsYXNzTmFtZSA9IGZvcm1hdFR5cGVOYW1lKHJlZi5jbGFzc1JlZmVyZW5jZUlkKTsKICBjb25zdCBwcm90byA9IHRhYmxlcy5wcm90b3MuZ2V0KHJlZi5wcm90b1JlZmVyZW5jZUlkKTsKICBsZXQgcGFyYW1zID0gIiI7CiAgaWYgKHByb3RvICYmIHByb3RvLnBhcmFtZXRlcnNJZCkgewogICAgY29uc3QgbGlzdCA9IHRhYmxlcy50eXBlTGlzdHMuZ2V0KHByb3RvLnBhcmFtZXRlcnNJZCk7CiAgICBpZiAobGlzdCAmJiBsaXN0LnR5cGVSZWZlcmVuY2VJZHMpIHsKICAgICAgcGFyYW1zID0gbGlzdC50eXBlUmVmZXJlbmNlSWRzLm1hcChpZCA9PiBmb3JtYXRUeXBlTmFtZShpZCkpLmpvaW4oJywgJyk7CiAgICB9CiAgfQogIGNvbnN0IHJldHVyblR5cGUgPSBwcm90byA/IGZvcm1hdFR5cGVOYW1lKHByb3RvLnJldHVyblR5cGVJZCkgOiAiIjsKICByZXR1cm4gYCR7cmV0dXJuVHlwZX0gJHtjbGFzc05hbWV9LiR7cmVmLm5hbWV9KCR7cGFyYW1zfSlgOwp9CgpmdW5jdGlvbiBmb3JtYXRGaWVsZE5hbWUoZmllbGRSZWZJZCkgewogIGNvbnN0IHJlZiA9IHRhYmxlcy5maWVsZFJlZnMuZ2V0KGZpZWxkUmVmSWQpOwogIGlmICghcmVmKSByZXR1cm4gIlVua25vd24gZmllbGQiOwogIGNvbnN0IGNsYXNzTmFtZSA9IGZvcm1hdFR5cGVOYW1lKHJlZi5jbGFzc1JlZmVyZW5jZUlkKTsKICBjb25zdCB0eXBlID0gZm9ybWF0VHlwZU5hbWUocmVmLnR5cGVSZWZlcmVuY2VJZCk7CiAgcmV0dXJuIGAke3R5cGV9ICR7Y2xhc3NOYW1lfS4ke3JlZi5uYW1lfWA7Cn0KCmZ1bmN0aW9uIGdldEZpbGVOYW1lKG9yaWdpbikgewogIGlmICghb3JpZ2luKSByZXR1cm4gIlVua25vd24iOwogIGNvbnN0IGZpbGVPcmlnaW4gPSB0YWJsZXMub3JpZ2lucy5nZXQob3JpZ2luLmZpbGVPcmlnaW5JZCk7CiAgcmV0dXJuIGZpbGVPcmlnaW4gPyBmaWxlT3JpZ2luLmZpbGVuYW1lIDogIlVua25vd24iOwp9CgpmdW5jdGlvbiBnZXRNYXZlbkNvb3JkaW5hdGUob3JpZ2luKSB7CiAgaWYgKCFvcmlnaW4pIHJldHVybiBudWxsOwogIGNvbnN0IGZpbGVPcmlnaW4gPSB0YWJsZXMub3JpZ2lucy5nZXQob3JpZ2luLmZpbGVPcmlnaW5JZCk7CiAgcmV0dXJuIGZpbGVPcmlnaW4/Lm1hdmVuQ29vcmRpbmF0ZTsKfQoKZnVuY3Rpb24gZ2V0TWF2ZW5Db29yZGluYXRlU3RyaW5nKG1hdmVuQ29vcmRpbmF0ZSkgewogIHJldHVybiBtYXZlbkNvb3JkaW5hdGUuZ3JvdXBJZCArICI6IiArIG1hdmVuQ29vcmRpbmF0ZS5hcnRpZmFjdElkICsgIjoiICsgbWF2ZW5Db29yZGluYXRlLnZlcnNpb247Cn0KCmZ1bmN0aW9uIGdldE9yaWdpblN0cmluZyhvcmlnaW4pIHsKICBpZiAoIW9yaWdpbikgcmV0dXJuICJVbmtub3duIjsKICBjb25zdCBtYXZlbkNvb3JkaW5hdGUgPSBnZXRNYXZlbkNvb3JkaW5hdGUob3JpZ2luKTsKICBpZiAobWF2ZW5Db29yZGluYXRlKSB7CiAgICByZXR1cm4gZ2V0TWF2ZW5Db29yZGluYXRlU3RyaW5nKG1hdmVuQ29vcmRpbmF0ZSk7CiAgfQogIGNvbnN0IG5hbWUgPSBnZXRGaWxlTmFtZShvcmlnaW4pOwogIGxldCByZXMgPSBuYW1lOwogIGlmIChvcmlnaW4ubGluZU51bWJlcikgewogICAgcmVzICs9ICI6IiArIG9yaWdpbi5saW5lTnVtYmVyOwogICAgaWYgKG9yaWdpbi5jb2x1bW5OdW1iZXIpIHJlcyArPSAiOiIgKyBvcmlnaW4uY29sdW1uTnVtYmVyOwogIH0KICByZXR1cm4gcmVzOwp9CgpmdW5jdGlvbiBlc2NhcGVIdG1sKHRleHQpIHsKICBpZiAoIXRleHQpIHJldHVybiAiIjsKICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICBkaXYudGV4dENvbnRlbnQgPSB0ZXh0OwogIHJldHVybiBkaXYuaW5uZXJIVE1MOwp9CgpmdW5jdGlvbiBmb3JtYXRTdGF0c0JyZWFrZG93bihjbGFzc2VzLCBtZXRob2RzLCBmaWVsZHMpIHsKICBjb25zdCBwYXJ0cyA9IFtdOwogIGlmIChjbGFzc2VzID4gMCkgcGFydHMucHVzaChgJHtjbGFzc2VzfSBjbGFzcyR7Y2xhc3NlcyAhPT0gMSA/ICdlcycgOiAnJ31gKTsKICBpZiAobWV0aG9kcyA+IDApIHBhcnRzLnB1c2goYCR7bWV0aG9kc30gbWV0aG9kJHttZXRob2RzICE9PSAxID8gJ3MnIDogJyd9YCk7CiAgaWYgKGZpZWxkcyA+IDApIHBhcnRzLnB1c2goYCR7ZmllbGRzfSBmaWVsZCR7ZmllbGRzICE9PSAxID8gJ3MnIDogJyd9YCk7CiAgcmV0dXJuIHBhcnRzLmxlbmd0aCA+IDAgPyBgKCR7cGFydHMuam9pbignLCAnKX0pYCA6ICcnOwp9CgppZiAoIWNvbnRhaW5lckRhdGEgJiYgIWVtYmVkZGVkUHJvdG9EYXRhU291cmNlKSB7CiAgcmVuZGVyV2VsY29tZU1lc3NhZ2UoKTsKICBkcm9wWm9uZS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKfQo8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+Cg==");
  }

  public static String getSummaryHtmlTemplate() {
    return decodeBase64(
        "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+Qmxhc3QgUmFkaXVzIFN1bW1hcnkgUmVwb3J0czwvdGl0bGU+CiAgICA8c3R5bGU+Ym9keSB7CiAgICBmb250LWZhbWlseTogJ1JvYm90bycsIHNhbnMtc2VyaWY7CiAgICBwYWRkaW5nOiAycmVtOwogICAgYmFja2dyb3VuZC1jb2xvcjogI2Y1ZjVmNTsKICAgIG1hcmdpbjogMDsKICAgIGNvbG9yOiAjMzMzOwp9Ci5jb250YWluZXIgewogICAgbWF4LXdpZHRoOiAxMjAwcHg7CiAgICBtYXJnaW46IDAgYXV0bzsKICAgIGJhY2tncm91bmQ6IHdoaXRlOwogICAgcGFkZGluZzogMnJlbTsKICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgIGJveC1zaGFkb3c6IDAgMXB4IDNweCByZ2JhKDAsMCwwLDAuMSk7Cn0KaDEgewogICAgY29sb3I6ICMzZjUxYjU7CiAgICBtYXJnaW4tdG9wOiAwOwp9CnRhYmxlIHsKICAgIHdpZHRoOiAxMDAlOwogICAgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsKICAgIG1hcmdpbi10b3A6IDFyZW07Cn0KdGgsIHRkIHsKICAgIHRleHQtYWxpZ246IGxlZnQ7CiAgICBwYWRkaW5nOiAxMnB4OwogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlZWU7Cn0KdGggewogICAgYmFja2dyb3VuZC1jb2xvcjogI2Y4ZjlmYTsKICAgIGZvbnQtd2VpZ2h0OiA1MDA7CiAgICBjb2xvcjogIzU1NTsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIHVzZXItc2VsZWN0OiBub25lOwp9CnRoOmxhc3QtY2hpbGQgewogICAgY3Vyc29yOiBkZWZhdWx0Owp9CnRoOmhvdmVyIHsKICAgIGJhY2tncm91bmQtY29sb3I6ICNmMGYxZjI7Cn0KdHI6aG92ZXIgewogICAgYmFja2dyb3VuZC1jb2xvcjogI2ZjZmNmYzsKfQoucmVwb3J0LWxpbmsgewogICAgY29sb3I6ICMxYTczZTg7CiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7CiAgICBmb250LXdlaWdodDogNTAwOwp9Ci5yZXBvcnQtbGluazpob3ZlciB7CiAgICB0ZXh0LWRlY29yYXRpb246IHVuZGVybGluZTsKfQouc3RhdC1iYWRnZSB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZThmNWU5OwogICAgY29sb3I6ICMyZTdkMzI7CiAgICBwYWRkaW5nOiAycHggOHB4OwogICAgYm9yZGVyLXJhZGl1czogMTJweDsKICAgIGZvbnQtc2l6ZTogMC44cmVtOwogICAgZm9udC13ZWlnaHQ6IDUwMDsKICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgIG1hcmdpbi1yaWdodDogNHB4Owp9Ci5zdGF0LWJhZGdlLndhcm4gewogICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjNlMDsKICAgIGNvbG9yOiAjZWY2YzAwOwp9Ci5zdGF0LWJhZGdlLmVycm9yIHsKICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmViZWU7CiAgICBjb2xvcjogI2M2MjgyODsKfQoubmFtZS1yb3cgdGQgewogICAgYmFja2dyb3VuZC1jb2xvcjogI2Y4ZjlmYTsKICAgIGZvbnQtd2VpZ2h0OiA1MDA7CiAgICBjb2xvcjogIzNmNTFiNTsKICAgIHBhZGRpbmctdG9wOiAxcmVtOwogICAgcGFkZGluZy1ib3R0b206IDAuNXJlbTsKICAgIGJvcmRlci1ib3R0b206IG5vbmU7Cn0KLmRhdGEtcm93IHRkIHsKICAgIHBhZGRpbmctYm90dG9tOiAxcmVtOwogICAgYm9yZGVyLXRvcDogbm9uZTsKfQo8L3N0eWxlPgogICAgPGxpbmsgaHJlZj0iaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3MyP2ZhbWlseT1Sb2JvdG86d2dodEAzMDA7NDAwOzUwMDs3MDAmZGlzcGxheT1zd2FwIiByZWw9InN0eWxlc2hlZXQiPgogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vcHJvdG9idWZqc0A3LjIuNC9kaXN0L3Byb3RvYnVmLm1pbi5qcyI+PC9zY3JpcHQ+CjwvaGVhZD4KPGJvZHk+CiAgICA8ZGl2IGNsYXNzPSJjb250YWluZXIiPgogICAgICAgIDxoMT5CbGFzdCBSYWRpdXMgUmVwb3J0czwvaDE+CiAgICAgICAgPGRpdiBpZD0idGFibGUtY29udGFpbmVyIj4KICAgICAgICAgICAgPHRhYmxlPgogICAgICAgICAgICAgICAgPHRoZWFkPgogICAgICAgICAgICAgICAgICAgIDx0cj4KICAgICAgICAgICAgICAgICAgICAgICAgPHRoIGRhdGEtc29ydD0icnVsZXMiPktlZXAgUnVsZXM8L3RoPgogICAgICAgICAgICAgICAgICAgICAgICA8dGggZGF0YS1zb3J0PSJpdGVtcyI+S2VwdCBJdGVtczwvdGg+CiAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBkYXRhLXNvcnQ9ImNsYXNzZXMiPktlcHQgQ2xhc3NlczwvdGg+CiAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBkYXRhLXNvcnQ9Im1ldGhvZHMiPktlcHQgTWV0aG9kczwvdGg+CiAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBkYXRhLXNvcnQ9ImZpZWxkcyI+S2VwdCBGaWVsZHM8L3RoPgogICAgICAgICAgICAgICAgICAgICAgICA8dGg+UHJvYmxlbWF0aWMgUnVsZXM8L3RoPgogICAgICAgICAgICAgICAgICAgIDwvdHI+CiAgICAgICAgICAgICAgICA8L3RoZWFkPgogICAgICAgICAgICAgICAgPHRib2R5IGlkPSJzdW1tYXJ5LXRhYmxlLWJvZHkiPgogICAgICAgICAgICAgICAgICAgIDwhLS0gSmF2YVNjcmlwdCB3aWxsIHBvcHVsYXRlIHRoaXMgLS0+CiAgICAgICAgICAgICAgICA8L3Rib2R5PgogICAgICAgICAgICA8L3RhYmxlPgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+CgogICAgPHNjcmlwdCBpZD0iYmxhc3RyYWRpdXMtcHJvdG8iIHR5cGU9InRleHQvcGxhaW4iPi8vIENvcHlyaWdodCAoYykgMjAyNiwgdGhlIFI4IHByb2plY3QgYXV0aG9ycy4gUGxlYXNlIHNlZSB0aGUgQVVUSE9SUyBmaWxlCi8vIGZvciBkZXRhaWxzLiBBbGwgcmlnaHRzIHJlc2VydmVkLiBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhCi8vIEJTRC1zdHlsZSBsaWNlbnNlIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUuCnN5bnRheCA9ICJwcm90bzMiOwoKcGFja2FnZSBjb20uYW5kcm9pZC50b29scy5yOC5ibGFzdHJhZGl1cy5wcm90bzsKCi8vIERvbid0IHB1dCBhbGwgbWVzc2FnZXMgdW5kZXIgdGhlIG91dGVyIGNsYXNzLgpvcHRpb24gamF2YV9tdWx0aXBsZV9maWxlcyA9IHRydWU7CgovLyBDYW1lbC1jYXNlIHRoZSBvdXRlciBjbGFzcyBuYW1lIChkZWZhdWx0IGlzIGBCbGFzdHJhZGl1c3N1bW1hcnlgKS4Kb3B0aW9uIGphdmFfb3V0ZXJfY2xhc3NuYW1lID0gIkJsYXN0UmFkaXVzU3VtbWFyeVByb3RvcyI7CgovLyBKYXZhIHBhY2thZ2UgY29uc2lzdGVudCB3aXRoIFI4IGNvbnZlbnRpb24uCm9wdGlvbiBqYXZhX3BhY2thZ2UgPSAiY29tLmFuZHJvaWQudG9vbHMucjguYmxhc3RyYWRpdXMucHJvdG8iOwoKbWVzc2FnZSBCbGFzdFJhZGl1c1N1bW1hcnkgewogIC8vIE5hbWUgdGhhdCBpZGVudGlmaWVzIHRoZSBidWlsZC4KICBzdHJpbmcgbmFtZSA9IDE7CgogIC8vIExpbmsgdG8gdGhlIGZ1bGwgcmVwb3J0LgogIHN0cmluZyBsaW5rID0gMjsKCiAgLy8gSW5mbyBhYm91dCBudW1iZXIgb2YgaXRlbXMuCiAgdWludDMyIGNsYXNzX2NvdW50ID0gMzsKICB1aW50MzIgZmllbGRfY291bnQgPSA0OwogIHVpbnQzMiBtZXRob2RfY291bnQgPSA1OwoKICAvLyBJbmZvIGFib3V0IG51bWJlciBvZiBrZWVwIHJ1bGVzLgogIHVpbnQzMiBrZWVwX3J1bGVfY291bnQgPSA2OwogIHVpbnQzMiBrZWVwX3J1bGVfcGFja2FnZV93aWRlX2NvdW50ID0gNzsKCiAgLy8gSW5mbyBhYm91dCBudW1iZXIgb2Yga2VwdCBpdGVtcy4KICBLZWVwSW5mb0NvbGxlY3Rpb25TdW1tYXJ5IGtlcHRfY2xhc3NlcyA9IDg7CiAgS2VlcEluZm9Db2xsZWN0aW9uU3VtbWFyeSBrZXB0X2ZpZWxkcyA9IDk7CiAgS2VlcEluZm9Db2xsZWN0aW9uU3VtbWFyeSBrZXB0X21ldGhvZHMgPSAxMDsKCiAgLy8gSW5mbyBhYm91dCBwcm9ibGVtYXRpYyBydWxlcy4KICByZXBlYXRlZCBLZWVwUnVsZUJsYXN0UmFkaXVzU3VtbWFyeSBrZWVwX3J1bGVfYmxhc3RfcmFkaXVzID0gMTE7Cn0KCm1lc3NhZ2UgS2VlcEluZm9Db2xsZWN0aW9uU3VtbWFyeSB7CiAgdWludDMyIGl0ZW1fY291bnQgPSAxOwogIHVpbnQzMiBub19vYmZ1c2NhdGlvbl9jb3VudCA9IDI7CiAgdWludDMyIG5vX29wdGltaXphdGlvbl9jb3VudCA9IDM7CiAgdWludDMyIG5vX3Nocmlua2luZ19jb3VudCA9IDQ7Cn0KCm1lc3NhZ2UgS2VlcFJ1bGVCbGFzdFJhZGl1c1N1bW1hcnkgewogIHN0cmluZyBzb3VyY2UgPSAxOwogIHVpbnQzMiBpdGVtX2NvdW50ID0gMjsKfQo8L3NjcmlwdD4KICAgIDxzY3JpcHQgaWQ9ImJsYXN0cmFkaXVzLWRhdGEiIHR5cGU9ImFwcGxpY2F0aW9uL2pzb24iPjwvc2NyaXB0PgogICAgPHNjcmlwdD4vLyBDb3B5cmlnaHQgKGMpIDIwMjYsIHRoZSBSOCBwcm9qZWN0IGF1dGhvcnMuIFBsZWFzZSBzZWUgdGhlIEFVVEhPUlMgZmlsZQovLyBmb3IgZGV0YWlscy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYQovLyBCU0Qtc3R5bGUgbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKKGZ1bmN0aW9uKCkgewogIGNvbnN0IHByb3RvU2NoZW1hID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JsYXN0cmFkaXVzLXByb3RvJykudGV4dENvbnRlbnQ7CiAgY29uc3Qgc3VtbWFyaWVzRGF0YSA9IEpTT04ucGFyc2UoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JsYXN0cmFkaXVzLWRhdGEnKS50ZXh0Q29udGVudCk7CiAgY29uc3QgdGFibGVCb2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N1bW1hcnktdGFibGUtYm9keScpOwogIGNvbnN0IGhlYWRlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCd0aFtkYXRhLXNvcnRdJyk7CgogIGNvbnN0IHJvb3QgPSBwcm90b2J1Zi5wYXJzZShwcm90b1NjaGVtYSkucm9vdDsKICBjb25zdCBCbGFzdFJhZGl1c1N1bW1hcnkgPSByb290Lmxvb2t1cFR5cGUoImNvbS5hbmRyb2lkLnRvb2xzLnI4LmJsYXN0cmFkaXVzLnByb3RvLkJsYXN0UmFkaXVzU3VtbWFyeSIpOwoKICBsZXQgc3VtbWFyaWVzID0gW107CiAgbGV0IGN1cnJlbnRTb3J0ID0gewogICAga2V5OiBudWxsLAogICAgZGVzYzogdHJ1ZQogIH07CgogIHN1bW1hcmllc0RhdGEuZm9yRWFjaChzdW1tYXJ5QmFzZTY0ID0+IHsKICAgIHRyeSB7CiAgICAgIGNvbnN0IGJpbmFyeSA9IGF0b2Ioc3VtbWFyeUJhc2U2NCk7CiAgICAgIGNvbnN0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYmluYXJ5Lmxlbmd0aCk7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmluYXJ5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgYnl0ZXNbaV0gPSBiaW5hcnkuY2hhckNvZGVBdChpKTsKICAgICAgfQogICAgICBjb25zdCBtZXNzYWdlID0gQmxhc3RSYWRpdXNTdW1tYXJ5LmRlY29kZShieXRlcyk7CiAgICAgIGNvbnN0IHN1bW1hcnkgPSBCbGFzdFJhZGl1c1N1bW1hcnkudG9PYmplY3QobWVzc2FnZSwgewogICAgICAgIGRlZmF1bHRzOiB0cnVlLAogICAgICAgIGVudW1zOiBTdHJpbmcKICAgICAgfSk7CiAgICAgIHN1bW1hcmllcy5wdXNoKHN1bW1hcnkpOwogICAgfSBjYXRjaCAoZSkgewogICAgICBjb25zb2xlLmVycm9yKCJGYWlsZWQgdG8gZGVjb2RlIHN1bW1hcnk6IiwgZSk7CiAgICB9CiAgfSk7CgogIGZ1bmN0aW9uIHJlbmRlclRhYmxlKCkgewogICAgdGFibGVCb2R5LmlubmVySFRNTCA9ICcnOwogICAgc3VtbWFyaWVzLmZvckVhY2gocmVuZGVyUm93KTsKICB9CgogIGZ1bmN0aW9uIHJlbmRlclJvdyhzdW1tYXJ5KSB7CiAgICAvLyBOYW1lIHJvdyAoRnVsbCB3aWR0aCkKICAgIGNvbnN0IG5hbWVUciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7CiAgICBuYW1lVHIuY2xhc3NOYW1lID0gJ25hbWUtcm93JzsKICAgIGNvbnN0IG5hbWVUZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7CiAgICBuYW1lVGQuY29sU3BhbiA9IDY7CiAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgbGluay5jbGFzc05hbWUgPSAncmVwb3J0LWxpbmsnOwogICAgbGluay5ocmVmID0gc3VtbWFyeS5saW5rIHx8IHN1bW1hcnkubmFtZS5yZXBsYWNlKCcucGInLCAnLmh0bWwnKTsKICAgIGxpbmsudGV4dENvbnRlbnQgPSBzdW1tYXJ5Lm5hbWU7CiAgICBuYW1lVGQuYXBwZW5kQ2hpbGQobGluayk7CiAgICBuYW1lVHIuYXBwZW5kQ2hpbGQobmFtZVRkKTsKICAgIHRhYmxlQm9keS5hcHBlbmRDaGlsZChuYW1lVHIpOwoKICAgIC8vIERhdGEgcm93CiAgICBjb25zdCBkYXRhVHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOwogICAgZGF0YVRyLmNsYXNzTmFtZSA9ICdkYXRhLXJvdyc7CgogICAgY29uc3QgcnVsZXNUZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7CiAgICBydWxlc1RkLnRleHRDb250ZW50ID0gc3VtbWFyeS5rZWVwUnVsZUNvdW50IHx8ICIwIjsKICAgIGlmIChzdW1tYXJ5LmtlZXBSdWxlUGFja2FnZVdpZGVDb3VudCAmJiBzdW1tYXJ5LmtlZXBSdWxlUGFja2FnZVdpZGVDb3VudCAhPT0gMCkgewogICAgICBjb25zdCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwogICAgICBzcGFuLmNsYXNzTmFtZSA9ICdzdGF0LWJhZGdlIHdhcm4nOwogICAgICBzcGFuLnRleHRDb250ZW50ID0gYCR7c3VtbWFyeS5rZWVwUnVsZVBhY2thZ2VXaWRlQ291bnR9IHBhY2thZ2Utd2lkZWA7CiAgICAgIHNwYW4udGl0bGUgPSAiTnVtYmVyIG9mIGtlZXAgcnVsZXMgdGhhdCBrZWVwIGFuIGVudGlyZSBwYWNrYWdlIjsKICAgICAgcnVsZXNUZC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdicicpKTsKICAgICAgcnVsZXNUZC5hcHBlbmRDaGlsZChzcGFuKTsKICAgIH0KICAgIGRhdGFUci5hcHBlbmRDaGlsZChydWxlc1RkKTsKCiAgICBjb25zdCBpdGVtc1RkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTsKICAgIGNvbnN0IHRvdGFsS2VwdCA9IChzdW1tYXJ5LmtlcHRDbGFzc2VzPy5pdGVtQ291bnQgfHwgMCkgKwogICAgICAoc3VtbWFyeS5rZXB0TWV0aG9kcz8uaXRlbUNvdW50IHx8IDApICsKICAgICAgKHN1bW1hcnkua2VwdEZpZWxkcz8uaXRlbUNvdW50IHx8IDApOwogICAgY29uc3QgdG90YWxJdGVtcyA9IChzdW1tYXJ5LmNsYXNzQ291bnQgfHwgMCkgKyAoc3VtbWFyeS5tZXRob2RDb3VudCB8fCAwKSArIChzdW1tYXJ5LmZpZWxkQ291bnQgfHwgMCk7CiAgICBpdGVtc1RkLnRleHRDb250ZW50ID0gYCR7dG90YWxLZXB0fSAvICR7dG90YWxJdGVtc31gOwogICAgZGF0YVRyLmFwcGVuZENoaWxkKGl0ZW1zVGQpOwoKICAgIGNvbnN0IGNsYXNzZXNUZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7CiAgICBjbGFzc2VzVGQuaW5uZXJIVE1MID0gZm9ybWF0S2VlcEluZm8oc3VtbWFyeS5rZXB0Q2xhc3Nlcywgc3VtbWFyeS5jbGFzc0NvdW50KTsKICAgIGRhdGFUci5hcHBlbmRDaGlsZChjbGFzc2VzVGQpOwoKICAgIGNvbnN0IG1ldGhvZHNUZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7CiAgICBtZXRob2RzVGQuaW5uZXJIVE1MID0gZm9ybWF0S2VlcEluZm8oc3VtbWFyeS5rZXB0TWV0aG9kcywgc3VtbWFyeS5tZXRob2RDb3VudCk7CiAgICBkYXRhVHIuYXBwZW5kQ2hpbGQobWV0aG9kc1RkKTsKCiAgICBjb25zdCBmaWVsZHNUZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7CiAgICBmaWVsZHNUZC5pbm5lckhUTUwgPSBmb3JtYXRLZWVwSW5mbyhzdW1tYXJ5LmtlcHRGaWVsZHMsIHN1bW1hcnkuZmllbGRDb3VudCk7CiAgICBkYXRhVHIuYXBwZW5kQ2hpbGQoZmllbGRzVGQpOwoKICAgIGNvbnN0IHByb2JsZW1hdGljVGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpOwogICAgaWYgKHN1bW1hcnkua2VlcFJ1bGVCbGFzdFJhZGl1cyAmJiBzdW1tYXJ5LmtlZXBSdWxlQmxhc3RSYWRpdXMubGVuZ3RoID4gMCkgewogICAgICBjb25zdCB1bCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7CiAgICAgIHVsLnN0eWxlLm1hcmdpbiA9ICcwJzsKICAgICAgdWwuc3R5bGUucGFkZGluZ0xlZnQgPSAnMCc7CiAgICAgIHVsLnN0eWxlLmxpc3RTdHlsZVR5cGUgPSAnbm9uZSc7CiAgICAgIHVsLnN0eWxlLmZvbnRTaXplID0gJzAuOXJlbSc7CiAgICAgIHN1bW1hcnkua2VlcFJ1bGVCbGFzdFJhZGl1cy5mb3JFYWNoKHJ1bGUgPT4gewogICAgICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTsKICAgICAgICBsaS5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnNHB4JzsKCiAgICAgICAgY29uc3QgYmFkZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CiAgICAgICAgYmFkZ2UuY2xhc3NOYW1lID0gJ3N0YXQtYmFkZ2Ugd2Fybic7CiAgICAgICAgYmFkZ2UudGV4dENvbnRlbnQgPSBydWxlLml0ZW1Db3VudDsKICAgICAgICBiYWRnZS50aXRsZSA9ICJOdW1iZXIgb2YgaXRlbXMga2VwdCBieSB0aGUgcnVsZS4iOwogICAgICAgIGJhZGdlLnN0eWxlLm1hcmdpblJpZ2h0ID0gJzhweCc7CgogICAgICAgIGxpLmFwcGVuZENoaWxkKGJhZGdlKTsKICAgICAgICBjb25zdCBjb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwogICAgICAgIGNvZGUuc3R5bGUuZm9udEZhbWlseSA9ICdtb25vc3BhY2UnOwogICAgICAgIGNvZGUuc3R5bGUuZm9udFNpemUgPSAnMC44NXJlbSc7CiAgICAgICAgY29kZS50ZXh0Q29udGVudCA9IHJ1bGUuc291cmNlOwogICAgICAgIGxpLmFwcGVuZENoaWxkKGNvZGUpOwogICAgICAgIHVsLmFwcGVuZENoaWxkKGxpKTsKICAgICAgfSk7CiAgICAgIHByb2JsZW1hdGljVGQuYXBwZW5kQ2hpbGQodWwpOwogICAgfSBlbHNlIHsKICAgICAgcHJvYmxlbWF0aWNUZC50ZXh0Q29udGVudCA9ICItIjsKICAgIH0KICAgIGRhdGFUci5hcHBlbmRDaGlsZChwcm9ibGVtYXRpY1RkKTsKCiAgICB0YWJsZUJvZHkuYXBwZW5kQ2hpbGQoZGF0YVRyKTsKICB9CgogIGZ1bmN0aW9uIGZvcm1hdEtlZXBJbmZvKGtlZXBJbmZvLCB0b3RhbCkgewogICAgaWYgKCFrZWVwSW5mbykgcmV0dXJuICIwIC8gIiArICh0b3RhbCB8fCAwKTsKICAgIGNvbnN0IGtlcHQgPSBrZWVwSW5mby5pdGVtQ291bnQgfHwgMDsKICAgIGxldCBiYWRnZXMgPSAiIjsKICAgIGlmIChrZWVwSW5mby5ub09iZnVzY2F0aW9uQ291bnQgPiAwKSB7CiAgICAgIGJhZGdlcyArPSBgPHNwYW4gY2xhc3M9InN0YXQtYmFkZ2UiIHRpdGxlPSJObyBvYmZ1c2NhdGlvbiI+JHtrZWVwSW5mby5ub09iZnVzY2F0aW9uQ291bnQgfHwgMH0gT0JGPC9zcGFuPmA7CiAgICB9CiAgICBpZiAoa2VlcEluZm8ubm9PcHRpbWl6YXRpb25Db3VudCA+IDApIHsKICAgICAgYmFkZ2VzICs9IGA8c3BhbiBjbGFzcz0ic3RhdC1iYWRnZSB3YXJuIiB0aXRsZT0iTm8gb3B0aW1pemF0aW9uIj4ke2tlZXBJbmZvLm5vT3B0aW1pemF0aW9uQ291bnQgfHwgMH0gT1BUPC9zcGFuPmA7CiAgICB9CiAgICBpZiAoa2VlcEluZm8ubm9TaHJpbmtpbmdDb3VudCA+IDApIHsKICAgICAgYmFkZ2VzICs9IGA8c3BhbiBjbGFzcz0ic3RhdC1iYWRnZSBlcnJvciIgdGl0bGU9Ik5vIHNocmlua2luZyI+JHtrZWVwSW5mby5ub1Nocmlua2luZ0NvdW50IHx8IDB9IFNIUjwvc3Bhbj5gOwogICAgfQogICAgcmV0dXJuIGAke2tlcHR9IC8gJHt0b3RhbCB8fCAwfTxicj4ke2JhZGdlc31gOwogIH0KCiAgZnVuY3Rpb24gc29ydFN1bW1hcmllcyhrZXkpIHsKICAgIGlmIChjdXJyZW50U29ydC5rZXkgPT09IGtleSkgewogICAgICBjdXJyZW50U29ydC5kZXNjID0gIWN1cnJlbnRTb3J0LmRlc2M7CiAgICB9IGVsc2UgewogICAgICBjdXJyZW50U29ydC5rZXkgPSBrZXk7CiAgICAgIGN1cnJlbnRTb3J0LmRlc2MgPSB0cnVlOwogICAgfQoKICAgIHN1bW1hcmllcy5zb3J0KChhLCBiKSA9PiB7CiAgICAgIGxldCB2YWxBLCB2YWxCOwogICAgICBzd2l0Y2ggKGtleSkgewogICAgICAgIGNhc2UgJ3J1bGVzJzoKICAgICAgICAgIHZhbEEgPSBhLmtlZXBSdWxlQ291bnQgfHwgMDsKICAgICAgICAgIHZhbEIgPSBiLmtlZXBSdWxlQ291bnQgfHwgMDsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ2l0ZW1zJzoKICAgICAgICAgIHZhbEEgPSAoYS5rZXB0Q2xhc3Nlcz8uaXRlbUNvdW50IHx8IDApICsgKGEua2VwdE1ldGhvZHM/Lml0ZW1Db3VudCB8fCAwKSArIChhLmtlcHRGaWVsZHM/Lml0ZW1Db3VudCB8fCAwKTsKICAgICAgICAgIHZhbEIgPSAoYi5rZXB0Q2xhc3Nlcz8uaXRlbUNvdW50IHx8IDApICsgKGIua2VwdE1ldGhvZHM/Lml0ZW1Db3VudCB8fCAwKSArIChiLmtlcHRGaWVsZHM/Lml0ZW1Db3VudCB8fCAwKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ2NsYXNzZXMnOgogICAgICAgICAgdmFsQSA9IChhLmtlcHRDbGFzc2VzICYmIGEua2VwdENsYXNzZXMuaXRlbUNvdW50KSB8fCAwOwogICAgICAgICAgdmFsQiA9IChiLmtlcHRDbGFzc2VzICYmIGIua2VwdENsYXNzZXMuaXRlbUNvdW50KSB8fCAwOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnbWV0aG9kcyc6CiAgICAgICAgICB2YWxBID0gKGEua2VwdE1ldGhvZHMgJiYgYS5rZXB0TWV0aG9kcy5pdGVtQ291bnQpIHx8IDA7CiAgICAgICAgICB2YWxCID0gKGIua2VwdE1ldGhvZHMgJiYgYi5rZXB0TWV0aG9kcy5pdGVtQ291bnQpIHx8IDA7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdmaWVsZHMnOgogICAgICAgICAgdmFsQSA9IChhLmtlcHRGaWVsZHMgJiYgYS5rZXB0RmllbGRzLml0ZW1Db3VudCkgfHwgMDsKICAgICAgICAgIHZhbEIgPSAoYi5rZXB0RmllbGRzICYmIGIua2VwdEZpZWxkcy5pdGVtQ291bnQpIHx8IDA7CiAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgcmV0dXJuIDA7CiAgICAgIH0KICAgICAgcmV0dXJuIGN1cnJlbnRTb3J0LmRlc2MgPyB2YWxCIC0gdmFsQSA6IHZhbEEgLSB2YWxCOwogICAgfSk7CgogICAgcmVuZGVyVGFibGUoKTsKICAgIHVwZGF0ZUhlYWRlclN0eWxlcygpOwogIH0KCiAgZnVuY3Rpb24gdXBkYXRlSGVhZGVyU3R5bGVzKCkgewogICAgaGVhZGVycy5mb3JFYWNoKHRoID0+IHsKICAgICAgY29uc3Qga2V5ID0gdGguZ2V0QXR0cmlidXRlKCdkYXRhLXNvcnQnKTsKICAgICAgdGguaW5uZXJIVE1MID0gdGgudGV4dENvbnRlbnQucmVwbGFjZSgvIFvilrLilrxdLywgJycpOwogICAgICBpZiAoa2V5ID09PSBjdXJyZW50U29ydC5rZXkpIHsKICAgICAgICB0aC5pbm5lckhUTUwgKz0gY3VycmVudFNvcnQuZGVzYyA/ICcg4pa8JyA6ICcg4payJzsKICAgICAgfQogICAgfSk7CiAgfQoKICBoZWFkZXJzLmZvckVhY2godGggPT4gewogICAgdGguYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgIHNvcnRTdW1tYXJpZXModGguZ2V0QXR0cmlidXRlKCdkYXRhLXNvcnQnKSk7CiAgICB9KTsKICB9KTsKCiAgc29ydFN1bW1hcmllcygnaXRlbXMnKTsKfSkoKTs8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+Cg==");
  }

  private static String decodeBase64(String string) {
    return new String(Base64.getDecoder().decode(string), StandardCharsets.UTF_8);
  }
}
